webpackJsonp([22],{I37D:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});e("xwui");var s={name:"Wallet",components:{},props:["walletType"],data:function(){return{usdtData:{number:"",image:[]},usdtRecharge:!1,listData:"",realMoney:0,isLoad:!1,isFinished:!1,isRefresh:!1,pageNo:1,tabsState:1,tabsIndex:0,taskTabs:[{type:1,text:this.$t("wallet.default[3]")},{type:3,text:this.$t("wallet.default[4]")}],showTurn:!1,showDraw:!1,showPicker:!1,selectBank:"",isSubmit:!1,turnData:{username:"",turn_money:"",drawword:""},drawData:{draw_type:"bank",user_bank_id:"",draw_money:0,usdt_money:0,drawword:""},showBank:!1,bankList:"",bankName:""}},computed:{cardList:function(){return this.$store.state.BankCardList.flatMap(function(t){return t.bank_name+" "+t.card_no.replace(/^(.{4}).*(.{4})$/,"$1 **** $2")})}},watch:{$route:function(){var t=this;this.walletType?(this.tabsIndex=this.taskTabs.findIndex(function(a){return a.type==t.walletType}),this.tabsState=this.walletType):(this.tabsState=1,this.tabsIndex=0),this.getListData("init")}},created:function(){var t=this;this.$Model.GetBankCardList(),this.$parent.navBarTitle=this.$t("wallet.default[0]"),this.listData=this.taskTabs.flatMap(function(t){return[""]}),this.walletType&&(this.tabsIndex=this.taskTabs.findIndex(function(a){return a.type==t.walletType}),this.tabsState=this.walletType),this.getListData("init"),this.drawData.draw_money=Number(this.InitData.setting.min_w||100),this.drawData.usdt_money=Number(this.drawData.draw_money*this.InitData.pay_out_exchange).toFixed(2),this.realMoney=.93*this.drawData.draw_money,this.bankList=this.InitData.BanksList.flatMap(function(t){return t.bank})},mounted:function(){},activated:function(){},destroyed:function(){},methods:{inputDrawMoney:function(t){t=parseInt(t),this.drawData.usdt_money=Number(t*this.InitData.pay_out_exchange).toFixed(2),this.realMoney=.93*t},onConfirmBank:function(t,a){this.bankName=t,this.drawData.bank_id=this.InitData.BanksList[a].bank_id,this.showBank=!1},goTurn:function(t){var a=this;this.$Model.GetBankCardList(function(t){1==t.code?(a.bankList=t.data.flatMap(function(t){return t.bank_name+" "+t.card_no.replace(/^(.{4}).*(.{4})$/,"$1 **** $2")}),1!=a.UserInfo.is_fund_password?a.$Dialog.Alert(a.$t("wallet.msg[0]"),function(){a.$router.push("/user/info")}):a.cardList.length&&a.$router.push("/user/withdraw")):a.$Dialog.Alert(a.$t("wallet.msg[1]"),function(){a.$router.push("/user/bankCard")})})},openInfo:function(t){},onConfirm:function(t,a){this.drawData.user_bank_id=this.BankCardList[a].id,this.drawData.ifsc=this.BankCardList[a].bank_branch_name,this.selectBank=t,this.showPicker=!1},submitDraw:function(){var t=this;this.drawData.user_bank_id?this.drawData.draw_money?this.drawData.drawword?(this.isSubmit=!0,this.$Model.Draw(this.drawData,function(a){t.isSubmit=!1,1==a.code&&(t.showDraw=!1,t.drawData={draw_type:"bank",user_bank_id:"",draw_money:Number(t.InitData.setting.min_w||100),drawword:""},t.selectBank="",t.getListData("init"))})):this.$Dialog.Toast(this.$t("wallet.placeholder[2]")):this.$Dialog.Toast(this.$t("wallet.placeholder[1]")):this.$Dialog.Toast(this.$t("wallet.placeholder[3]"))},onLoad:function(){this.getListData("load")},changeTabs:function(t){this.tabsState=this.taskTabs[t].type,this.getListData("init")},getListData:function(t){var a=this;this.isLoad=!0,this.isRefresh=!1,"load"==t?this.pageNo+=1:(this.pageNo=1,this.isFinished=!1),0==this.tabsIndex?this.$Model.GetRechargeRecord({state:0,page_no:this.pageNo},function(e){a.isLoad=!1,1==e.code?(a.listData[a.tabsIndex]="load"==t?a.listData[a.tabsIndex].concat(e.info):e.info,a.pageNo==e.data_total_page?a.isFinished=!0:a.isFinished=!1):(a.listData[a.tabsIndex]="",a.isFinished=!0)}):1==this.tabsIndex?this.$Model.GetDrawRecord({state:0,page_no:this.pageNo},function(e){a.isLoad=!1,1==e.code?(a.listData[a.tabsIndex]="load"==t?a.listData[a.tabsIndex].concat(e.info):e.info,a.pageNo==e.data_total_page?a.isFinished=!0:a.isFinished=!1):(a.listData[a.tabsIndex]="",a.isFinished=!0)}):this.$Model.FundDetails({trade_type:11,page_no:this.pageNo},function(e){a.isLoad=!1,1==e.code?(a.listData[a.tabsIndex]="load"==t?a.listData[a.tabsIndex].concat(e.list):e.list,a.pageNo==e.data_total_page?a.isFinished=!0:a.isFinished=!1):(a.listData[a.tabsIndex]="",a.isFinished=!0)})},onRefresh:function(){this.getListData("init")},afterRead:function(t){t.status="uploading",t.message=this.$t("upload[0]"),this.uploadImgs(t)},compressImg:function(t){var a=this;this.$Util.CompressImg(t.file.type,t.content,750,function(e){var s=new FormData;s.append("token",localStorage.Token),s.append("type",3),s.append("image",e,t.file.name),a.$Model.UploadImg(s,function(e){1==e.code?(t.message=a.$t("upload[2]"),t.status="success",t.url=e.url):(t.status="failed",t.message=a.$t("upload[3]"))})})},uploadImgs:function(t){var a=this;if(t.length)t.forEach(function(t){if(!t.file.type.match(/image/))return t.status="failed",void(t.message=a.$t("upload[1]"));a.compressImg(t)});else{if(!t.file.type.match(/image/))return t.status="failed",void(t.message=this.$t("upload[1]"));this.compressImg(t)}},submitUsdt:function(){var t=this;return!this.isSubmit&&(this.usdtData.number<1?(this.$Dialog.Alert(this.$t("recharge.placeholder[3]",{currency:" 1",min:" USDT"})),!1):(this.$Dialog.Toast("success"),this.isSubmit=!0,void this.$Model.RechargeOrder({money:Number(this.usdtData.number/this.InitData.pay_exchange).toFixed(2),usdt_money:this.usdtData.number,recharge_id:"1",name:"TRC20-USDT",screenshots:this.usdtData.image},function(a){t.$Dialog.Toast(a.code_dec),t.isSubmit=!1,1==a.code&&(t.usdtRecharge=!1)})))}}},i={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"PageBox"},[e("div",{staticClass:"ScrollBox Wallet"},[e("div",{staticClass:"balance"},[t._v("\n      "+t._s(t.UserInfo.balance)),e("small",[e("small",[t._v(t._s(t.InitData.currency))])]),e("br")]),t._v(" "),e("div",{staticClass:"tool"},[e("div",[e("router-link",{attrs:{to:"/user/recharge"}},[t._v(t._s(t.$t("wallet.default[1]")))]),t._v(" "),e("a",{attrs:{href:"javascript:;"},on:{click:function(a){return t.goTurn("draw")}}},[t._v(t._s(t.$t("wallet.default[2]")))])],1)]),t._v(" "),e("van-tabs",{attrs:{type:"card",background:"#f7f7f7",border:!1,color:"#f7f7f7","title-inactive-color":"#999","title-active-color":"#609f4c"},on:{change:t.changeTabs},model:{value:t.tabsIndex,callback:function(a){t.tabsIndex=a},expression:"tabsIndex"}},t._l(t.taskTabs,function(a,s){return e("van-tab",{key:s,staticStyle:{padding:"0 12px"},attrs:{title:a.text}},[e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isRefresh,callback:function(a){t.isRefresh=a},expression:"isRefresh"}},[e("van-list",{class:{Empty:!t.listData[t.tabsIndex].length},attrs:{finished:t.isFinished,"finished-text":t.listData[t.tabsIndex].length?t.$t("vanPull[0]"):t.$t("vanPull[1]")},on:{load:t.onLoad},model:{value:t.isLoad,callback:function(a){t.isLoad=a},expression:"isLoad"}},[0==t.tabsIndex||1==t.tabsIndex?e("div",t._l(t.listData[t.tabsIndex],function(a,s){return e("van-cell",{key:a.dan,staticClass:"FundItem",attrs:{border:!1},on:{click:function(e){return t.openInfo(a.dan)}},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",[e("span",[t._v(t._s(a.dan))]),t._v(" "),e("span",[t._v(t._s(a.adddate))])]),t._v(" "),e("div",[e("span",{staticClass:"money"},[t._v(t._s(Number(a.money))),e("small",[t._v(t._s(t.InitData.currency))])]),t._v(" "),e("span",[t._v(t._s(a.status_desc))])])]},proxy:!0}],null,!0)},[e("div",{class:"icon tag"+t.tabsIndex,attrs:{slot:"icon"},slot:"icon"},[t._v("\n                  "+t._s(0==t.tabsIndex?t.$t("wallet.default[5]"):t.$t("wallet.default[6]"))+"\n                ")])])}),1):e("div",t._l(t.listData[t.tabsIndex],function(a,s){return e("van-cell",{key:a.order_id,staticClass:"FundItem",attrs:{border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[e("div",[e("span",[t._v(t._s(a.trade_number))]),t._v(" "),e("span",[t._v(t._s(a.trade_time))])]),t._v(" "),e("div",[e("span",{staticClass:"money"},[t._v(t._s(a.jj)+t._s(a.trade_amount))]),t._v(" "),e("span",[t._v(t._s(a.remarks))])])]},proxy:!0}],null,!0)},[e("div",{class:"icon tag"+t.tabsIndex,attrs:{slot:"icon"},slot:"icon"},[t._v("To")])])}),1)])],1)],1)}),1)],1),t._v(" "),e("van-action-sheet",{attrs:{title:"TRC20-USDT","close-on-popstate":""},model:{value:t.usdtRecharge,callback:function(a){t.usdtRecharge=a},expression:"usdtRecharge"}},[e("van-field",{staticStyle:{height:"0",width:"0",padding:"0",position:"absolute"},attrs:{type:"password",autocomplete:"off"}}),t._v(" "),e("van-field",{attrs:{type:"number",label:t.$t("recharge.label[0]")+" (USDT)",placeholder:"1 USDT = "+Number(1/t.InitData.pay_exchange).toFixed(2)+" "+t.InitData.currency,clearable:"",size:"large"},model:{value:t.usdtData.number,callback:function(a){t.$set(t.usdtData,"number","string"==typeof a?a.trim():a)},expression:"usdtData.number"}}),t._v(" "),e("van-button",{staticStyle:{"font-size":"16px","border-radius":"0"},attrs:{type:"danger",block:""},on:{click:t.submitUsdt}},[t._v("\n      "+t._s(t.$t("wallet.label[3]"))+"\n    ")])],1),t._v(" "),e("van-action-sheet",{attrs:{title:t.$t("wallet.default[2]"),"close-on-popstate":""},model:{value:t.showDraw,callback:function(a){t.showDraw=a},expression:"showDraw"}},[e("van-field",{staticStyle:{height:"0",width:"0",padding:"0",position:"absolute"},attrs:{type:"password",autocomplete:"off"}}),t._v(" "),e("van-field",{attrs:{type:"text",label:t.$t("wallet.label[0]"),placeholder:t.$t("wallet.placeholder[0]"),size:"large",readonly:""},on:{click:function(a){t.showPicker=!0}},model:{value:t.selectBank,callback:function(a){t.selectBank=a},expression:"selectBank"}}),t._v(" "),e("van-field",{attrs:{type:"number",label:t.$t("wallet.label[1]"),placeholder:t.$t("wallet.placeholder[1]"),clearable:"",size:"large"},on:{input:t.inputDrawMoney},model:{value:t.drawData.draw_money,callback:function(a){t.$set(t.drawData,"draw_money","string"==typeof a?a.trim():a)},expression:"drawData.draw_money"}}),t._v(" "),e("van-field",{attrs:{type:"password",label:t.$t("wallet.label[2]"),placeholder:t.$t("wallet.placeholder[2]"),clearable:"",size:"large"},model:{value:t.drawData.drawword,callback:function(a){t.$set(t.drawData,"drawword","string"==typeof a?a.trim():a)},expression:"drawData.drawword"}}),t._v(" "),t.UserInfo.vip_level>1?e("van-divider",{staticStyle:{"line-height":"140%"}},[e("div",[t._v("Retirada deducir 7% IRPF, renta después de impuestos: "+t._s(t.realMoney))])]):t._e(),t._v(" "),t.InitData.drawNotice&&t.InitData.drawNotice.length?e("van-divider",{staticStyle:{"line-height":"1.2"}},[e("div",{domProps:{innerHTML:t._s(t.InitData.drawNotice[0].content)}})]):t._e(),t._v(" "),e("div",{staticStyle:{padding:"0 16px",margin:"16px 0"}},[e("van-button",{staticStyle:{"font-size":"16px"},attrs:{type:"danger",block:""},on:{click:t.submitDraw}},[t._v(t._s(t.$t("wallet.label[3]"))+"\n      ")])],1)],1),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(a){t.showPicker=a},expression:"showPicker"}},[e("van-picker",{attrs:{"show-toolbar":"",columns:t.cardList},on:{confirm:t.onConfirm,cancel:function(a){t.showPicker=!1}}})],1),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.showBank,callback:function(a){t.showBank=a},expression:"showBank"}},[e("van-picker",{attrs:{"show-toolbar":"",columns:t.bankList},on:{confirm:t.onConfirmBank,cancel:function(a){t.showBank=!1}}})],1)],1)},staticRenderFns:[]};var n=e("VU/8")(s,i,!1,function(t){e("tV/A")},"data-v-7d233586",null);a.default=n.exports},"tV/A":function(t,a){}});