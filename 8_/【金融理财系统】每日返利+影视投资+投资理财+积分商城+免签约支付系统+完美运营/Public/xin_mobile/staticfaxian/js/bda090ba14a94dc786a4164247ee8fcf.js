var isXtchatWindowReady=false;
var deskeymnstr="2c5d0124254dc7f9bb2e259d52367354";
var xtuids=null;
var mnuserarea="吉林";
var xtAgentIconXpos="left";var xtAgentIconYpos=10;var isShowXtOnlineServiceBox=true;var agentminiwidth="280";var agentminiheight="480";var isShowMinUI=0;var customerPublishId="2c90eeb669c2745c0169c3531d6933b7";var agentsiteimgaddresspath="https://4.molinsoft.com/";var agentlinktext="";var agenticonStyle=1;var agentshowStyle=0;var agentpreLoadMode=1;var agentinviteStyle=1;var agentisplaysound=1;var agentisshowhistorymsg=1;var agentisshowphone=0;var agentfirstrobot=0;var agentwelcommWordShowRate=1;var agentautoSendMsgaRate=2;var agentopenStyle=0;var isServiceMenuEnable=0;var ismnuserhaspay=1;var isUseRobot="0";var xtInviteBoxTimerOut=0;var xtInviteBoxOpenLimit=0;var xtOpenOnPageVisitSize=0;var xtOpenOnVisitTimeCount=0;var clientStyleWebPath="https://4.molinsoft.com/agentIcon/default";var xtcustomerCanUseVideo="1";var xtcustomerCanUseMic="1";var isWriteCustomerInfo="0";var agenticonaddressimg="/agentIcon/default/agentIcon.png";var agentbgaddressimg="agentIcon/default/InviteBg.png";var customerCompnyName="基石金控";var mnrobotWelcomeWords="您好，我是客服机器人，很高兴为您服务";var customerPageStyleName="default";var customerPageLogo="custmerLogo.png";var xtserviceListIcon=null;var mnisAppraise="0";var xtrobotName="";var xtAgentCurLanguage="zh_CN";var xtChatnewMsgAlert="新的消息";XtLanguageConst={loadservicemenufaile:"\u52A0\u8F7D\u5BA2\u670D\u83DC\u5355\u5931\u8D25",queueInfo:"\u6B63\u5728\u6392\u961F\uFF0C\u60A8\u524D\u9762\u8FD8\u6709#waitcount\u4EBA",waitingnosend:"\u6B63\u5728\u6392\u961F\u4E2D\uFF0C\u4E0D\u80FD\u53D1\u9001\u6D88\u606F",onlineservice:"\u5728\u7EBF\u5BA2\u670D",telinputphone:"\u5EA7\u673A\u8BF7\u5728\u53F7\u7801\u524D\u52A0\u4E0A\u533A\u53F7",xtmainAgentOnlineWords:"\u60A8\u597D\uFF0C\u5F88\u9AD8\u5174\u4E3A\u60A8\u670D\u52A1",pleaseinput:"\u8BF7\u5728\u8FD9\u91CC\u8F93\u5165\u6D88\u606F\u6216\u7C98\u8D34QQ\u622A\u56FE",inputing:"\u6B63\u5728\u8F93\u5165...",appraisefaile:"\u63D0\u4EA4\u8BC4\u4EF7\u5931\u8D25\u8BF7\u91CD\u8BD5",sendPhoneResult:"\u53F7\u7801\u5DF2\u53D1\u9001\uFF0C\u8BF7\u7B49\u5F85\u56DE\u7535",closeIcon:"\u2573",getflashplayer:'\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301flash player,\u8BF7\u70B9\u6B64\u5F00\u542F&nbsp;&nbsp;<a href="https://www.adobe.com/go/getflashplayer"><img src="https://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="\u5F00\u542F Adobe Flash Player" style="vertical-align: middle;" /></a>',email:"\u90AE\u7BB1",xtmainAgentOfflineWords:"\u60A8\u597D\uFF0C\u6211\u73B0\u5728\u4E0D\u5728\u7EBF\uFF0C\u8BF7\u60A8\u7559\u8A00",pleaseinputremark:"\u8BF7\u5728\u8FD9\u91CC\u8F93\u5165\u5907\u6CE8...",appraiseforthanks:"\u611F\u8C22\u60A8\u7684\u8BC4\u4EF7\uFF01",msgScreened:"\u6D88\u606F\u88AB\u62D2\u6536",custimerInfo:"\u5BA2\u6237\u4FE1\u606F",mnsoftinfo:"\u83AB\u90BB\u5BA2\u670D\u8F6F\u4EF6",sitedesc:"\u7F51\u7AD9\u4ECB\u7ECD",msgtoolong:"\u53EA\u80FD\u53D1\u9001200\u5B57\u7B26\u6D88\u606F",telpanelfooter:"\u672C\u6B21\u901A\u8BDD\u5168\u7A0B\u514D\u8D39\uFF0C\u8BF7\u60A8\u653E\u5FC3\u62E8\u6253",xtConnectAgentMsg:"\u6B63\u5728\u4E3A\u60A8\u8F6C\u63A5\u5BA2\u670D\uFF0C\u8BF7\u7A0D\u7B49",mobileNumber:"\u624B\u673A\u53F7",insertImage:"\u63D2\u5165\u56FE\u7247",selectAppraise:"\u8BF7\u9009\u62E9\u8BC4\u4EF7\u9879",fileTranfinished:"\u6587\u4EF6\u4F20\u8F93\u5B8C\u6210",qqchat:"QQ\u54A8\u8BE2",msgreplay:"\u56DE\u590D",personService:"\u8F6C\u4EBA\u5DE5\u670D\u52A1",phonechat:"\u7535\u8BDD\u54A8\u8BE2",sexwemain:"\u5973",yours:"\u60A8\uFF1A",appraiseLabel:"\u670D\u52A1\u8BC4\u4EF7",selectimg:"\u8BF7\u9009\u62E9\u6587\u4EF6",chageAgentMsg:"\u5DF2\u4E3A\u60A8\u8F6C\u63A5\u5230",sex:"\u6027\u522B",msg:"\u6D88\u606F",appraiseTitle:"\u8BF7\u60A8\u5BF9\u6211\u4EEC\u7684\u670D\u52A1\u505A\u51FA\u8BC4\u4EF7",submit:"\u63D0\u4EA4",telinputmobile:"\u624B\u673A\u8BF7\u76F4\u63A5\u8F93\u5165",video:"\u89C6\u9891",sendmsgerr:"\u7CFB\u7EDF\u9519\u8BEF\uFF0C\u6D88\u606F\u53D1\u9001\u5931\u8D25",serviceingforyou:"\u6B63\u5728\u4E3A\u60A8\u670D\u52A1",nickname:"\u6635\u79F0",noanwser:"\u672A\u627E\u5230\u76F8\u5173\u7B54\u6848,\u8BF7\u54A8\u8BE2\u4EBA\u5DE5\u5BA2\u670D",customerName:"\u59D3\u540D",send:"\u53D1\u9001",phoneNumber:"\u7535\u8BDD\u53F7\u7801",robottitle:"\u5BA2\u670D\u673A\u5668\u4EBA",close:"\u5173\u95ED",remark:"\u5907\u6CE8",tranfile:"\u53D1\u9001\u6587\u4EF6",pleaseInputPhone:"\u8BF7\u8F93\u5165\u7535\u8BDD\u53F7\u7801",submiting:"\u6B63\u5728\u63D0\u4EA4\uFF0C\u8BF7\u7A0D\u7B49",chatended:"\u4F1A\u8BDD\u5DF2\u7ED3\u675F",companyInfo:"\u4F01\u4E1A\u4ECB\u7ECD:\u65E0",nosavecustomerinfo:"\u8BF7\u586B\u5199\u60A8\u7684\u57FA\u672C\u8D44\u6599\u540E\u518D\u53D1\u9001\u6D88\u606F",temgroupmembercomein:"\u52A0\u5165\u8BA8\u8BBA\u7EC4",requestsound:"\u8BF7\u6C42\u8BED\u97F3\u901A\u8BDD",temgroupend:"\u8BA8\u8BBA\u7EC4\u5DF2\u89E3\u6563",pleaseinputsex:"\u8BF7\u9009\u62E9\u6027\u522B",clear:"\u6E05\u9664",msgalert:"\u6D88\u606F\u63D0\u793A",temgroupmemeberexit:"\u9000\u51FA\u8BA8\u8BBA\u7EC4",arcodechat:"\u63CF\u7801\u54A8\u8BE2",age:"\u5E74\u9F84",phone:"\u7535\u8BDD",servicerobot:"\u8F6C\u5BA2\u670D\u673A\u5668\u4EBA",leavemessage:"\u7559\u8A00",jobs:"\u804C\u4F4D",savefaile:"\u4FDD\u5B58\u5931\u8D25",microphone:"\u8BED\u97F3",agemustnum:"\u5E74\u9F84\u53EA\u80FD\u4E3A\u6570\u5B57",uploading:"\u53D1\u9001\u4E2D...",telpaneltitle:"\u8BF7\u8F93\u5165\u53F7\u7801\uFF0C\u6211\u4EEC\u5C06\u7ACB\u5373\u7ED9\u60A8\u56DE\u7535",roboWelcomeMsg:"\u60A8\u597D\uFF0C\u6211\u662F\u5BA2\u670D\u673A\u5668\u4EBAxt,\u5F88\u9AD8\u5174\u548C\u4F60\u4EA4\u6D41\u3002",videoMic:"\u89C6\u9891\u8BED\u97F3",submitAppraise:"\u63D0\u4EA4\u8BC4\u4EF7",insertFace:"\u63D2\u5165\u8868\u60C5",requestvideo:"\u8BF7\u6C42\u89C6\u9891\u901A\u8BDD",sexmain:"\u7537",xtSystemMsg:"\u7CFB\u7EDF\u6D88\u606F",namenotnull:"\u59D3\u540D\u4E0D\u80FD\u4E3A\u7A7A",gotelpone:"\u62E8\u6253\u7535\u8BDD",savesuccuss:"\u4FDD\u5B58\u6210\u529F",neterr:"\u7F51\u7EDC\u9519\u8BEF",xtXgentOffWord:"\u79BB\u7EBF",usercard:"\u5BA2\u670D\u540D\u7247",chatendnosend:"\u4F1A\u8BDD\u5DF2\u7ED3\u675F\uFF0C\u4E0D\u80FD\u53D1\u9001\u6D88\u606F",emailchat:"\u90AE\u4EF6\u8054\u7CFB",xtXgentOnWord:"\u5728\u7EBF",backphone:"\u5BA2\u6237\u8BF7\u6C42\u8BED\u97F3\u901A\u8BDD,\u8BF7\u56DE\u7535"};var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),j=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],k=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){k=aB.plugins[ab].description;if(k&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;k=k.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(k.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(k.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(k)?parseInt(k.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0}}else{if(typeof af.ActiveXObject!=aq){try{var i=new ActiveXObject(X);if(i){k=i.GetVariable("$version");if(k){d=true;k=k.split(" ")[1].split(",");f=[parseInt(k[0],10),parseInt(k[1],10),parseInt(k[2],10)]}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:j}}(),aK=function(){if(!ah.w3){return}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP()}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false)}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP()}});if(af==top){(function(){if(ak){return}try{aL.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}aP()})()}}if(ah.wk){(function(){if(ak){return}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return}aP()})()}aC(aP)}}();function aP(){if(ak){return}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b)}catch(a){return}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]()}}function aj(a){if(ak){a()}else{Z[Z.length]=a}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false)}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false)}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a)}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a()}}else{af.onload=a}}}}}function aN(){if(aa){Y()}else{am()}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)]}}else{if(c<10){c++;setTimeout(arguments.callee,10);return}}d.removeChild(b);a=null;am()})()}else{am()}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var l=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var i=aS(c);if(i){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(l){a.success=true;a.ref=av(c);l(a)}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=i.getAttribute("width")||"0";e.height=i.getAttribute("height")||"0";if(i.getAttribute("class")){e.styleclass=i.getAttribute("class")}if(i.getAttribute("align")){e.align=i.getAttribute("align")}var f={};var d=i.getElementsByTagName("param");var k=d.length;for(var j=0;j<k;j++){if(d[j].getAttribute("name").toLowerCase()!="movie"){f[d[j].getAttribute("name")]=d[j].getAttribute("value")}}ae(e,f,c,l)}else{aF(i);if(l){l(a)}}}}}else{ay(c,true);if(l){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b}l(a)}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a}}}return d}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312)}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null}else{aJ=a;ad=h}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310"}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137"}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c}else{d.flashvars=c}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}aA(f,d,h)}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a)}else{setTimeout(arguments.callee,10)}})()}else{a.parentNode.replaceChild(aO(a),a)}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true))}}}}}return d}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d}if(a){if(typeof e.id==aq){e.id=c}if(ah.ie&&ah.win){var f="";for(var i in e){if(e[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){g.movie=e[i]}else{if(i.toLowerCase()=="styleclass"){f+=' class="'+e[i]+'"'}else{if(i.toLowerCase()!="classid"){f+=" "+i+'="'+e[i]+'"'}}}}}var h="";for(var j in g){if(g[j]!=Object.prototype[j]){h+='<param name="'+j+'" value="'+g[j]+'" />'}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id)}else{var b=ar(aD);b.setAttribute("type",aE);for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="styleclass"){b.setAttribute("class",e[k])}else{if(k.toLowerCase()!="classid"){b.setAttribute(k,e[k])}}}}for(var l in g){if(g[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"){aQ(b,l,g[l])}}a.parentNode.replaceChild(b,a);d=b}}return d}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a)}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a)}else{setTimeout(arguments.callee,10)}})()}else{b.parentNode.removeChild(b)}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null}}b.parentNode.removeChild(b)}}function aS(a){var c=null;try{c=aL.getElementById(a)}catch(b){}return c}function ar(a){return aL.createElement(a)}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b]}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false}function az(b,f,a,c){if(ah.ie&&ah.mac){return}var e=aL.getElementsByTagName("head")[0];if(!e){return}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1]}an=g}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f)}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"))}}}function ay(a,c){if(!aI){return}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.display=b}else{az("#"+a,"display:"+b)}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2])}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c])}for(var e in ah){ah[e]=null}ah=null;for(var f in swfobject){swfobject[f]=null}swfobject=null})}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false)}else{if(b){b({success:false,id:a})}}},getObjectById:function(a){if(ah.w3){return av(a)}},embedSWF:function(k,e,h,f,c,a,b,i,g,j){var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&k&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var q={};if(g&&typeof g===aD){for(var o in g){q[o]=g[o]}}q.data=k;q.width=h;q.height=f;var n={};if(i&&typeof i===aD){for(var p in i){n[p]=i[p]}}if(b&&typeof b===aD){for(var l in b){if(typeof n.flashvars!=aq){n.flashvars+="&"+l+"="+b[l]}else{n.flashvars=l+"="+b[l]}}}if(ao(c)){var m=aA(q,n,e);if(q.id==e){ay(e,true)}d.success=true;d.ref=m}else{if(a&&au()){q.data=a;ae(q,n,e,j);return}else{ay(e,true)}}if(j){j(d)}})}else{if(j){j(d)}}},switchOffAutoHideShow:function(){aI=false},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]}},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c)}else{return undefined}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c)}},removeSWF:function(a){if(ah.w3){aw(a)}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d)}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1]}if(b==null){return ai(a)}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)))}}}return""},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block"}}if(ap){ap(at)}}aU=false}}}}();var isXtPageLoadReady=false;String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};function mn$(a){return document.getElementById(a)}XtimGlobalObject={ns6:mn$&&!document.all,ie:document.all,xtflashVars:null,isIe6:navigator.appVersion.indexOf("MSIE 6.0")>-1,isIe7:navigator.appVersion.indexOf("MSIE 7.0")>-1,isIe8:navigator.appVersion.indexOf("MSIE 8.0")>-1,isIe9:navigator.appVersion.indexOf("MSIE 9.0")>-1,xtOpenWindowFun:null,deleteMsgIdArray:new Array(),customerId:null,curAgentId:null,curAgentName:null,curAgentUserName:null,curAgentSignature:null,curAgentAnswerTimeOutMsg:null,curAgentAnswerTimeOut:30,curAgentSex:"1",uid:null,pollingMethod:"checkMsg",pollingHanlder:0,connectIsStart:false,hasOpened:false,readeyEvents:[],waitcount:0,chatId:null,isChatEnd:false,isSaveCustomerInfo:null,pwdReg:/^(\w){1,20}$/,mobileReg:/^(13[0-9]|15[0-9]|18[0-9])\d{8}$/,noInitMsg:"\u521d\u59cb\u5316\u672a\u5b8c\u6210\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5",changeUrl:function(j){var d=/(http:\/\/|https:\/\/)?[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\s\"\"])*/gi;var h;var g=[];while((h=d.exec(j))!=null){g.push(h[0]);j=j.replace(h[0],"#xthref#")}if(g.length>0){var i="";var c=j.split("#xthref#");for(var b=0;b<c.length;b++){var k=c[b];i+=k;if(b<g.length){var a=g[b];var f=true;if(k.length>0){var e=k.substring(k.length-1);if(e=='"'||e=="'"||e=="="){f=false}}if(f){if(a.length>=4&&a.toLowerCase().substring(0,4)=="http"){i+='<a href="'+a+'" target="_blank">'+a+"</a>"}else{i+='<a href="http://'+a+'" target="_blank">'+a+"</a>"}}else{i+=a}}}return i}return j},escapeStr:function(a){return escape(encodeURIComponent(XtimGlobalObject.encodeutf8(a)))},decodeBase64:function(a){return new XtimGlobalObject.Base64().decode(a)},Base64:function(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";this.encode=function(c){var a="";var k,h,f,j,g,e,d;var b=0;c=_utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+_keyStr.charAt(j)+_keyStr.charAt(g)+_keyStr.charAt(e)+_keyStr.charAt(d)}return a};this.decode=function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=_keyStr.indexOf(c.charAt(b++));g=_keyStr.indexOf(c.charAt(b++));e=_keyStr.indexOf(c.charAt(b++));d=_keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!=64){a=a+String.fromCharCode(h)}if(d!=64){a=a+String.fromCharCode(f)}}a=_utf8_decode(a);return a};_utf8_encode=function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a};_utf8_decode=function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}},replace:function(d,a,b){var c=d.indexOf(a);var e="";if(c==-1){return d}e+=(d.substring(0,c)+b);if(c+a.length<d.length){e+=(XtimGlobalObject.replace(d.substring(c+a.length,d.length),a,b))}return e},generateUUID:function(){var b=new Date().getTime();var a="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var d=(b+Math.random()*16)%16|0;b=Math.floor(b/16);return(e=="x"?d:(d&3|8)).toString(16)});return a},hasDocType:function(){if(document.doctype!=null){return true}if(document.all!=null&&document.all[0].nodeType==8){return true}return false},isJsonP:function(){if(XtimGlobalObject.ie&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7||XtimGlobalObject.isIe8||XtimGlobalObject.isIe9)){return true}return false},getRadioBoxValue:function(b){var c=document.getElementsByName(b);for(var a=0;a<c.length;a++){if(c[a].checked){return c[a].value}}return null},getInfo:function(c){var d=new Object();d.left=d.right=d.top=d.bottom=0;var a=c.offsetWidth;var b=c.offsetHeight;while(c!=document.body){if(c.offsetParent==null){break}d.left+=c.offsetLeft;d.top+=c.offsetTop;c=c.offsetParent}d.right=d.left+a;d.bottom=d.top+b;return d},getPoint:function(d){var c=d.offsetTop;var b=d.offsetLeft;while(d=d.offsetParent){c+=d.offsetTop;b+=d.offsetLeft}var a=new Object();a.top=c;a.left=b;return a},getXtAgentByAgentId:function(c){var a=0;for(a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.agentId==c){return b;break}}},saveCustomerById:function(a){XtimGlobalObject.agentInviteSetCookie(customerPublishId,a,true);XtimGlobalObject.customerId=a},saveCustomerId:function(e,f,h,d,c,a,b,g){XtimGlobalObject.agentInviteSetCookie(customerPublishId,e,true);XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentId",f);XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentName",h);XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentUserName",d);XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentSex",c);XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentSignature",a);XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentAnswerTimeOutMsg",b);XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentAnswerTimeOut",g);XtimGlobalObject.customerId=e;XtimGlobalObject.curAgentId=f;XtimGlobalObject.curAgentName=h;XtimGlobalObject.curAgentUserName=d;XtimGlobalObject.curAgentSex=c;XtimGlobalObject.curAgentSignature=a;XtimGlobalObject.curAgentAnswerTimeOutMsg=b;XtimGlobalObject.curAgentAnswerTimeOut=g;if(mn$("xtmsgtitlecontainerlabel")!=null){mn$("xtmsgtitlecontainerlabel").innerHTML=XtimGlobalObject.curAgentName}if(mn$("minxtmsgtitlecontainerlabel")!=null){mn$("minxtmsgtitlecontainerlabel").innerHTML=XtimGlobalObject.curAgentName}if(mn$("mnagentSignature")!=null){mn$("mnagentSignature").innerHTML=XtimGlobalObject.curAgentSignature}},showDiv:function(b){var d;if(document.all){d=document.all}else{d=document.getElementsByTagName("*")}var c=0;for(var a=0;a<d.length;a++){var e=d[a].style.zIndex;if(!isNaN(parseInt(e))&&e>c){c=parseInt(e)}}if(b.style.zIndex<parseInt(c)+1){b.style.zIndex=parseInt(c)+1}},formatDate:function(a){var d=a.getHours();if(d<10){d="0"+d}var b=a.getMinutes();if(b<10){b="0"+b}var c=a.getSeconds();if(c<10){c="0"+c}return d+":"+b+":"+c},addReadeyEvents:function(a){XtimGlobalObject.readeyEvents.push(a)},onreadystatechangeHandler:function(){if(document.readyState=="complete"){for(var b=0;b<XtimGlobalObject.readeyEvents.length;b++){var a=XtimGlobalObject.readeyEvents[b];a.call()}}},createXHR:function(){if(typeof XMLHttpRequest!="undefined"){return new XMLHttpRequest()}else{if(typeof ActiveXObject!="undefined"){if(typeof arguments.callee.activeXString!="string"){var b=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],d,a;for(d=0,a=b.length;d<a;d++){try{new ActiveXObject(b[d]);arguments.callee.activeXString=b[d];break}catch(c){}}}return new ActiveXObject(arguments.callee.activeXString)}else{throw new Error("no xhr object available")}}},findAgentSignature:function(d){var c=null;for(var a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.agentId==d){c=b;break}}if(c!=null){return c.agentSignature}else{return""}},findAgentAnswerTimeOutMsg:function(d){var c=null;for(var a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.agentId==d){c=b;break}}if(c!=null){return c.answerTimeOutMsg}else{return""}},findAgentAnswerTimeOut:function(d){var c=null;for(var a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.agentId==d){c=b;break}}if(c!=null){return c.answerTimeOut}else{return 0}},excuteServerResult:function(d){if(d!=null&&d.length>0){for(var c=0;c<d.length;c++){var a=d[c];if(typeof(a.msgId)!="undefined"&&a.msgId!=null){XtimGlobalObject.deleteMsgIdArray.push(a.msgId)}if(a.type=="saveCustomerId"){XtimGlobalObject.saveCustomerById(a.customerId)}else{if(a.type=="addMsg"){if(document.getElementById(a.msgId)==null&&!MobileChatWindow.hasHistoryMsg(a.msgId)){MobileChatWindow.addToHistory(a.msg,a.senderId,a.senderName,a.msgId);playxtmsgsound();xtAlertNewMsg()}MobileChatWindow.changeMenuTab(0);MobileChatWindow.isSendAgentOfflineMsg=false;XtimGlobalObject.addMsg(a.msg,a.senderId,a.senderName,a.msgId);if(MobileChatWindow.answerTimeOutHandler!=0){clearTimeout(MobileChatWindow.answerTimeOutHandler);MobileChatWindow.answerTimeOutHandler=0}if(mn$("xtmsgbuttonopenbutton")!=null){mn$("xtmsgbuttonopenbutton").innerHTML=XtLanguageConst.send}}else{if(a.type=="synCustomerMsg"){if(document.getElementById(a.msgId)==null&&!MobileChatWindow.hasHistoryMsg(a.msgId)){MobileChatWindow.addToHistory(a.msg,"customer",XtLanguageConst.yours,a.msgId)}XtimGlobalObject.addMsg(a.msg,"customer",XtLanguageConst.yours,a.msgId)}else{if(a.type=="stoplongPolling"){}else{if(a.type=="addZhuanjieMsg"){XtimGlobalObject.connectAgent(a.zhuanJieAgentId,0);var e=null;if(a.zhuanJieAgentSignature){e=a.zhuanJieAgentSignature}if(e==null||e==""){e=XtimGlobalObject.findAgentSignature(a.zhuanJieAgentId)}var f=null;if(a.zhuanJieAgentAnswerTimeOutMsg){f=a.zhuanJieAgentAnswerTimeOutMsg}if(f==null||f==""){f=XtimGlobalObject.findAgentAnswerTimeOutMsg(a.zhuanJieAgentId)}var g=0;if(a.zhuanJieAgentAnswerTimeOut>0){g=a.zhuanJieAgentAnswerTimeOut}if(g==0){f=XtimGlobalObject.findAgentAnswerTimeOut(a.zhuanJieAgentId)}XtimGlobalObject.saveCustomerId(XtimGlobalObject.customerId,a.zhuanJieAgentId,a.zhuanJieAgentName,a.zhuanJieAgentUserName,"0",e,f,f)}else{if(a.type=="changeZhuanjieMsg"){var e=null;if(a.zhuanJieAgentSignature){e=a.zhuanJieAgentSignature}if(e==null||e==""){e=XtimGlobalObject.findAgentSignature(a.zhuanJieAgentId)}var f=null;if(a.zhuanJieAgentAnswerTimeOutMsg){f=a.zhuanJieAgentAnswerTimeOutMsg}if(f==null||f==""){f=XtimGlobalObject.findAgentAnswerTimeOutMsg(a.zhuanJieAgentId)}var g=0;if(a.zhuanJieAgentAnswerTimeOut>0){g=a.zhuanJieAgentAnswerTimeOut}if(g==0){f=XtimGlobalObject.findAgentAnswerTimeOut(a.zhuanJieAgentId)}XtimGlobalObject.saveCustomerId(XtimGlobalObject.customerId,a.zhuanJieAgentId,a.zhuanJieAgentName,a.zhuanJieAgentUserName,"0",e,f,f)}else{if(a.type=="CameraActivity"){if(a.infoCode==0){XtimGlobalObject.addMsg('<span style="cursor:pointer" onclick="AgentsListWindow.clickopenchatwindow(\''+XtimGlobalObject.curAgentId+"','"+XtimGlobalObject.curAgentName+"',1);\">"+XtLanguageConst.requestvideo+"</span>","sysmsg");playxtmsgsound()}}else{if(a.type=="micActivity"){if(a.infoCode==0){XtimGlobalObject.addMsg('<span style="cursor:pointer" onclick="AgentsListWindow.clickopenchatwindow(\''+XtimGlobalObject.curAgentId+"','"+XtimGlobalObject.curAgentName+"',0);\">"+XtLanguageConst.requestsound+"</span>","sysmsg");playxtmsgsound()}}else{if(a.type=="inputState"){var b=mn$("miniinputStateDiv");if(b!=null){if(a.inputState=="1"){b.innerHTML=XtLanguageConst.inputing}else{b.innerHTML=""}}}else{if(a.type=="openAppraiseWin"){MobileChatWindow.openAppraiseDiv()}else{if(a.type=="openCustomerInfoWin"){MobileChatWindow.openCustomerInfoDiv()}else{if(a.type=="playminivideo"){MobileChatWindow.openChatWindow();MobileChatWindow.playVideo()}else{if(a.type=="temgroupend"){MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(XtLanguageConst.temgroupend,"sysmsg",null,a.msgId)}else{if(a.type=="temgroupmembercomein"){MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(a.msg+"&nbsp;"+XtLanguageConst.temgroupmembercomein,"sysmsg",null,a.msgId)}else{if(a.type=="temgroupmemberexit"){MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(a.exitAgentName+"&nbsp;"+XtLanguageConst.temgroupmemeberexit,"sysmsg",null,a.msgId)}else{if(a.type=="queueconnectsuccess"){XtimGlobalObject.waitcount=-1;MobileChatWindow.updateWaitingInfo();MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(XtimGlobalObject.curAgentName+"&nbsp;"+XtLanguageConst.serviceingforyou,"sysmsg",null,a.msgId)}else{if(a.type=="updatequeueinfo"){XtimGlobalObject.waitcount=a.waitcount;MobileChatWindow.updateWaitingInfo()}else{if(a.type=="endchat"){XtimGlobalObject.isChatEnd=true;if(mnisAppraise=="1"){MobileChatWindow.openAppraiseDiv()}MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(a.endChatMsg,"sysmsg",null,a.msgId);if(MobileChatWindow.answerTimeOutHandler!=0){clearTimeout(MobileChatWindow.answerTimeOutHandler);MobileChatWindow.answerTimeOutHandler=0}}else{if(a.type=="synSaveCustomerInfo"){XtimGlobalObject.isSaveCustomerInfo="1";XtimGlobalObject.agentInviteSetCookie("saveCustomer_"+customerPublishId,"1",true)}else{if(a.type=="screenmsg"){MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(XtLanguageConst.msgScreened,"sysmsg",null,a.msgId)}}}}}}}}}}}}}}}}}}}}}}},ajax:function(b,g,e,a,c){g=g||"get";e=e||null;var f=XtimGlobalObject.createXHR();f.onreadystatechange=function(){if(f.readyState==4){if(f.status>=200&&f.status<300||f.status==304){if(a!=null&&typeof a!="undefined"){a(f.responseText)}}else{if(c!=null&&typeof c!="undefined"){c()}}}};try{f.open(g,b,true)}catch(d){}if(g=="post"){try{f.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(d){}}try{f.send(e)}catch(d){}},longPolling:function(method,data){method=method||"get";data=data||null;var xhr=XtimGlobalObject.createXHR();xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){var responsetext=xhr.responseText;if(responsetext!=null&&responsetext!=""){var results=eval("("+responsetext+")");XtimGlobalObject.excuteServerResult(results)}}if(!XtimGlobalObject.isChatEnd){if(XtimGlobalObject.pollingMethod=="updateVisitTime"){window.setTimeout(function(){XtimGlobalObject.longPolling(method,data)},7*1000)}else{XtimGlobalObject.longPolling(method,data)}}}};var customerId=XtimGlobalObject.customerId;if(customerId==null){customerId=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true);if(customerId==null){customerId=""}}if(XtimGlobalObject.pageUrl==null||XtimGlobalObject.pageTitle==null){XtimGlobalObject.pageUrl=window.location.href;XtimGlobalObject.pageTitle=document.title;if(XtimGlobalObject.pageTitle==null){XtimGlobalObject.pageTitle=""}}var srcUrl=document.referrer;if(srcUrl!=null){srcUrl=srcUrl.trim();if(srcUrl!=""){srcUrl=XtimGlobalObject.escapeStr(srcUrl)}}else{srcUrl=""}if(XtimGlobalObject.chatId==null){XtimGlobalObject.chatId=XtimGlobalObject.generateUUID()}var deleteMsgIds=XtimGlobalObject.deleteMsgIdArray.join(",");XtimGlobalObject.deleteMsgIdArray=new Array();var pageparameters="pageTitle="+XtimGlobalObject.escapeStr(XtimGlobalObject.pageTitle)+"&srcUrl="+srcUrl+"&pageUrl="+XtimGlobalObject.escapeStr(XtimGlobalObject.pageUrl);var sendData=data;if(sendData==null){sendData=""}if(sendData==""){sendData+=pageparameters}else{sendData+="&"+pageparameters}var url=agentsiteimgaddresspath+"/CheckMsg?isJsonP=0&isMobile=0&deleteMsgIds="+deleteMsgIds+"&chatId="+XtimGlobalObject.chatId+"&action="+XtimGlobalObject.pollingMethod+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId+"&customerId="+customerId;xhr.open(method,url+"&radomid="+Math.random(),true);xhr.timeout=22*1000;if(method=="post"){xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}xhr.send(sendData)},longPollingJsonp:function(){if(XtimGlobalObject.isChatEnd){return}if(XtimGlobalObject.pollingHanlder!=0){window.clearTimeout(XtimGlobalObject.pollingHanlder);XtimGlobalObject.pollingHanlder=0}if(XtimGlobalObject.pollingMethod=="updateVisitTime"){window.setTimeout(function(){XtimGlobalObject.excuteJsonp()},7*1000)}else{XtimGlobalObject.excuteJsonp()}},excuteJsonp:function(){if(XtimGlobalObject.isChatEnd){return}var d=mn$("checkMsgScriptTag");if(d!=null){XtimGlobalObject.removeObjectInIE(d)}d=document.createElement("script");d.id="checkMsgScriptTag";document.body.appendChild(d);var e=XtimGlobalObject.customerId;if(e==null){e=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true);if(e==null){e=""}}if(XtimGlobalObject.pageUrl==null||XtimGlobalObject.pageTitle==null){XtimGlobalObject.pageUrl=window.location.href;XtimGlobalObject.pageTitle=document.title;if(XtimGlobalObject.pageTitle==null){XtimGlobalObject.pageTitle=""}}if(XtimGlobalObject.chatId==null){XtimGlobalObject.chatId=XtimGlobalObject.generateUUID()}var c=XtimGlobalObject.deleteMsgIdArray.join(",");XtimGlobalObject.deleteMsgIdArray=new Array();XtimGlobalObject.pollingHanlder=window.setTimeout(XtimGlobalObject.longPollingJsonp,22*1000);var a="&pageTitle="+encodeURI(XtimGlobalObject.pageTitle)+"&pageUrl="+encodeURIComponent(XtimGlobalObject.pageUrl)+"&radomid="+Math.random();var b=agentsiteimgaddresspath+"/CheckMsg?deleteMsgIds="+c+"&chatId="+XtimGlobalObject.chatId+"&pollingHanlder="+XtimGlobalObject.pollingHanlder+"&isJsonP=1&isMobile=0&action="+XtimGlobalObject.pollingMethod+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId+"&customerId="+e+a;d.src=b},serverJsonpMethod:function(a){XtimGlobalObject.excuteServerResult(a.results);if(a.pollingHanlder==XtimGlobalObject.pollingHanlder){XtimGlobalObject.longPollingJsonp()}},addMsg:function(d,c,a,b){MobileChatWindow.addMsg(d,c,a,b)},closeChatWindow:function(){MobileChatWindow.closeChatWindow()},checkAgentMsgFun:function(){if(XtimGlobalObject.isJsonP()){XtimGlobalObject.longPollingJsonp()}else{XtimGlobalObject.longPolling("post",null)}},startCheckAgentMsgFun:function(){if(XtimGlobalObject.connectIsStart){return}if(agentpreLoadMode==1){if(XtimGlobalObject.isJsonP()){XtimGlobalObject.longPollingJsonp()}else{XtimGlobalObject.longPolling("post",null)}}XtimGlobalObject.connectIsStart=true},openOnlineServiceBoxIsShow:function(){if(isShowXtOnlineServiceBox==true&&isShowMinUI==1){setOpenXtInviteBoxFun()}},setWaitInfo:function(a){XtimGlobalObject.waitcount=a},openXtChatWindow:function(){xtNoAlertNewMsg();if(agentopenStyle==0){MobileChatWindow.closeChatWindow();XtimGlobalObject.openLinkChatWindow(XtimGlobalObject.curAgentUserName)}else{MobileChatWindow.openChatWindowCenter(XtimGlobalObject.curAgentUserName)}},openLinkChatWindow:function(f){if(XtimGlobalObject.customerId==null){return}var k=0;var p=null;for(k=0;k<AgentsListWindow.agentItems.length;k++){var j=AgentsListWindow.agentItems[k];if(j.agentNo==f){p=j;break}}if(p==null){return}XtimGlobalObject.saveCustomerId(XtimGlobalObject.customerId,p.agentId,p.agentName,p.agentNo,p.sex,p.agentSignature,p.answerTimeOutMsg);var n=agentsiteimgaddresspath+"/customerService.jsp";var b=mn$("agentInviteListdiv");if(b!=null){b.style.display="none"}var o=false;try{var q=window.open("","","height=550,width=790,resizable=yes,top=100,left=100,location=no");if(typeof(q)!="undefined"&&q!=null){var e="customerId="+XtimGlobalObject.customerId;e+="&xtid="+f;e+="&openMediaType="+MobileChatWindow.openMediaType;if(MobileChatWindow.talkProductImgPath!=null){e+="&talkProductImgPath="+encodeURIComponent(MobileChatWindow.talkProductImgPath)}if(MobileChatWindow.talkProductName!=null){e+="&talkProductName="+encodeURIComponent(MobileChatWindow.talkProductName)}if(MobileChatWindow.talkProductPrice!=null){e+="&talkProductPrice="+encodeURIComponent(MobileChatWindow.talkProductPrice)}q.location=n+"?"+e;o=false}else{o=true}}catch(m){o=true}if(o){var h=mn$("xtOpenLinkChatWindowForm");if(h==null){h=document.createElement("FORM");h.id="xtOpenLinkChatWindowForm";h.method="GET";h.target="_blank";document.body.appendChild(h);var d=document.createElement("input");d.type="hidden";d.name="customerId";d.id="customerId";h.appendChild(d);var r=document.createElement("input");r.type="hidden";r.name="xtid";r.id="xtid";h.appendChild(r);var g=document.createElement("input");g.type="hidden";g.name="openMediaType";g.id="openMediaType";g.value=MobileChatWindow.openMediaType;if(MobileChatWindow.talkProductImgPath!=null){var c=document.createElement("input");c.type="hidden";c.name="talkProductImgPath";c.id="talkProductImgPath";c.value=MobileChatWindow.talkProductImgPath}if(MobileChatWindow.talkProductName!=null){var l=document.createElement("input");l.type="hidden";l.name="talkProductName";l.id="talkProductName";l.value=MobileChatWindow.talkProductName}if(MobileChatWindow.talkProductPrice!=null){var a=document.createElement("input");a.type="hidden";a.name="talkProductPrice";a.id="talkProductPrice";a.value=MobileChatWindow.talkProductPrice}h.appendChild(g)}mn$("xtid").value=f;mn$("customerId").value=XtimGlobalObject.customerId;h.action=n;h.submit()}},connectAgent:function(d,a){if(d==XtimGlobalObject.curAgentId){return}var b=mn$("connectAgentMsgScriptTag");if(b!=null){XtimGlobalObject.removeObjectInIE(b)}b=document.createElement("script");b.id="connectAgentMsgScriptTag";document.body.appendChild(b);var c=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true);if(c==null){c=XtimGlobalObject.customerId}if(c==null||c==""){return}b.src=agentsiteimgaddresspath+"/CheckMsg?action=changeAgent&isQueue="+a+"&jsCallType=1&agentId="+d+"&publishPointId="+customerPublishId+"&customerId="+c+"&radomid="+Math.random()},loadcssfile:function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);if(typeof b!="undefined"){document.getElementsByTagName("head")[0].appendChild(b)}},isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},removeObjectInIE:function(c){if(c){try{for(var a in c){if(typeof c[a]=="function"){c[a]=null}}}catch(b){}c.parentNode.removeChild(c)}},getXmlDoc:function(b){var a=null;if(window.DOMParser){var c=new DOMParser();a=c.parseFromString(b,"text/xml")}else{a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(b)}return a},encodeutf8:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},agentInviteGetCookie:function(d,c){var f=false;if(typeof(c)=="undefined"){f=false}else{f=c}if(f){try{b=localStorage.getItem(d)}catch(e){}}else{try{b=sessionStorage.getItem(d)}catch(e){}}if(b==null||b==""){var a=document.cookie.match(new RegExp("(^| )"+d+"=([^;]*)(;|$)"));var b=null;if(a!=null){try{b=unescape(a[2])}catch(e){}}}return b},agentInviteSetCookie:function(c,f,b){var a=new Date();var h=10000;a.setTime(a.getTime()+h*24*3600*1000);var g=false;if(typeof(b)=="undefined"){g=false}else{g=b}var d="";if(g){try{localStorage.setItem(c,f)}catch(e){}d=";expires="+a.toGMTString()}else{try{sessionStorage.setItem(c,f)}catch(e){}}document.cookie=c+"="+escape(f)+";path=/"+d},xtPageVisitCount:function(){var a=XtimGlobalObject.getXtPageVisitCount();a++;XtimGlobalObject.agentInviteSetCookie("xtVisitPageCount",a+"")},getXtPageVisitCount:function(){var a=XtimGlobalObject.agentInviteGetCookie("xtVisitPageCount");if(a!=null){a=parseInt(a)}else{a=0}return a},xtVisitTimeCount:function(){var a=XtimGlobalObject.getXtVisitTimeCount();a++;XtimGlobalObject.agentInviteSetCookie("xtVisitTimeCount",a+"");if(xtOpenOnVisitTimeCount>0&&a>=xtOpenOnVisitTimeCount&&XtimGlobalObject.xtOpenWindowFun!=null&&!XtimGlobalObject.hasOpened){XtimGlobalObject.xtOpenWindowFun.call();XtimGlobalObject.hasOpened=true}},getXtVisitTimeCount:function(){var a=XtimGlobalObject.agentInviteGetCookie("xtVisitTimeCount");if(a!=null){a=parseInt(a)}else{a=0}return a},showLoading:function(){var a=mn$("miniloadingdiv");if(a==null){a=document.createElement("div");a.id="miniloadingdiv";a.innerHTML="<img src="+clientStyleWebPath+'/loading.gif><label style="font-size:12px">'+XtLanguageConst.uploading+"</label>";document.body.appendChild(a)}var b=XtimGlobalObject.getPoint(mn$("minichattoolbar"));a.style.left=(b.left+2)+"px";var c=parseInt(mn$("xtChatWindowDiv").style.bottom);a.style.bottom=(c+124)+"px";a.style.display="block";XtimGlobalObject.showDiv(a)},closeLoading:function(){if(mn$("miniloadingdiv")!=null){mn$("miniloadingdiv").style.display="none"}},sendVisitUrl:function(){var f=XtimGlobalObject.agentInviteGetCookie("agentInviteCookieName");if(f==null){XtimGlobalObject.agentInviteSetCookie("agentInviteCookieName",Math.random()*10000000+""+Math.random()*10000000)}var a=document.all;if(a&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7)&&document.readyState!="complete"){XtimGlobalObject.addReadeyEvents(XtimGlobalObject.sendVisitUrl);return}var l=null;var d=null;if(typeof getmnconfig!="undefined"&&getmnconfig instanceof Function){var e=getmnconfig();if(e!=null){if(e.customerId&&e.customerId!=null&&e.customerId!=""){l=e.customerId;XtimGlobalObject.customerId=l;XtimGlobalObject.agentInviteSetCookie(customerPublishId,l,true)}if(e.customerName&&e.customerName!=null&&e.customerName!=""){d=e.customerName}}}if(l==null){l=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true)}if(l==null){l=XtimGlobalObject.customerId;if(l==null){l=""}}if(d==null){d=""}var c=document.createElement("script");var b=window.location.href;if(b!=null){}var k=document.referrer;if(k!=null){k=escape(encodeURIComponent(XtimGlobalObject.encodeutf8(k)))}else{k=""}var h=document.title;if(h==null){h=""}var j="";if(XtimGlobalObject.uid!=null&&XtimGlobalObject.uid.length>0){var g;for(g=0;g<XtimGlobalObject.uid.length;g++){if(g<XtimGlobalObject.uid.length-1){j+=XtimGlobalObject.uid[g]+","}else{j+=XtimGlobalObject.uid[g]}}}c.src=agentsiteimgaddresspath+"/VisitServlet?preLoadMode="+agentpreLoadMode+"&isMobile=0&agentId="+XtimGlobalObject.curAgentId+"&uid="+j+"&customerName="+encodeURIComponent(d)+"&customerId="+l+"&agentInviteCookie="+XtimGlobalObject.agentInviteGetCookie("agentInviteCookieName")+"&publishId="+customerPublishId+"&url="+encodeURIComponent(b)+"&srcUrl="+k+"&pageTitle="+escape(encodeURIComponent(XtimGlobalObject.encodeutf8(h)))+"&deskeystr="+encodeURIComponent(deskeymnstr);document.body.appendChild(c)},init:function(){if(document.body==null){document.write("<body></body>")}XtimGlobalObject.uid=xtuids;XtimGlobalObject.customerId=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true);XtimGlobalObject.curAgentId=XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_agentId");XtimGlobalObject.curAgentName=XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_agentName");XtimGlobalObject.curAgentUserName=XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_agentUserName");XtimGlobalObject.curAgentSex=XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_agentSex");XtimGlobalObject.curAgentSignature=XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_agentSignature");XtimGlobalObject.curAgentAnswerTimeOutMsg=XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_agentAnswerTimeOutMsg");XtimGlobalObject.curAgentAnswerTimeOut=XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_agentAnswerTimeOut");XtimGlobalObject.isSaveCustomerInfo=XtimGlobalObject.agentInviteGetCookie("saveCustomer_"+customerPublishId,true);if(window.addEventListener){window.addEventListener("focus",AgentMsgTaskAlert.stop,true);window.addEventListener("blur",AgentMsgTaskAlert.stop,true);document.addEventListener("mousedown",MobileChatWindow.onDocClickHideFaceDiv,true)}else{window.attachEvent("onblur",AgentMsgTaskAlert.stop);document.attachEvent("onmousedown",MobileChatWindow.onDocClickHideFaceDiv)}setInterval(XtimGlobalObject.xtVisitTimeCount,1000);XtimGlobalObject.xtPageVisitCount();XtimGlobalObject.loadcssfile(clientStyleWebPath+"/chatStyle.css");XtimGlobalObject.sendVisitUrl()}};openChatWindowCenter=function(a){MobileChatWindow.openChatWindowCenter(a)};openChatWindow=function(){XtimGlobalObject.openXtChatWindow()};closeMnVideoPanel=function(){MobileChatWindow.closeVideoPanel()};getXtChatFlashVars=function(){if(XtimGlobalObject.xtflashVars==null){var a=new Object();a.agentId=XtimGlobalObject.curAgentId;a.agentNo=XtimGlobalObject.curAgentUserName;a.publishPointId=customerPublishId;a.appSiteAddress=agentsiteimgaddresspath;a.openMediaType=MobileChatWindow.openMediaType;a.productName=MobileChatWindow.talkProductName;a.productImgPath=MobileChatWindow.talkProductImgPath;a.productPrice=MobileChatWindow.talkProductPrice;XtimGlobalObject.xtflashVars=a}return XtimGlobalObject.xtflashVars};getXtAgentCurLanguage=function(){return xtAgentCurLanguage};xtchatWindowReady=function(){isXtchatWindowReady=true};getXtPageLoadReady=function(){return isXtPageLoadReady};setXtPageLoadReady=function(){isXtPageLoadReady=true};getXtAgentBrowserType=function(){return mn$&&!document.all};getDocWidth=function(){var a=new Object();if(XtimGlobalObject.hasDocType()){a.bodyWidth=document.documentElement.clientWidth;a.bodyHeight=document.documentElement.clientHeight}else{a.bodyWidth=document.body.clientWidth;a.bodyHeight=document.body.clientHeight}return a};openXtChatWindow=function(f,c,h,e,d){if(f==null){return}var g=null;var a=0;for(a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.agentNo==f||b.agentId==f){g=b;break}}if(g!=null){if(typeof(c)=="undefined"){MobileChatWindow.talkProductName=null}else{MobileChatWindow.talkProductName=c}if(typeof(h)=="undefined"){MobileChatWindow.talkProductImgPath=null}else{MobileChatWindow.talkProductImgPath=h}if(typeof(e)=="undefined"){MobileChatWindow.talkProductPrice=null}else{MobileChatWindow.talkProductPrice=e}if(typeof(d)!="undefined"){MobileChatWindow.openMediaType=d}xtNoAlertNewMsg();MobileChatWindow.closeChatWindow();XtimGlobalObject.openLinkChatWindow(g.agentNo)}};openXtInviteBox=function(){AgentInviteWindow.openAgentInviteWindow()};sendImMsg=function(h,g,d,b){if(XtimGlobalObject.curAgentId==null){return false}if(typeof d=="undefined"||d==null){d=true}var f=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true);if(f==null){f=XtimGlobalObject.customerId;if(f==null){return false}}if(XtimGlobalObject.isJsonP()){var e=mn$("sendMsgScriptTag");if(e!=null){XtimGlobalObject.removeObjectInIE(e)}e=document.createElement("script");e.id="sendMsgScriptTag";document.body.appendChild(e);e.src=agentsiteimgaddresspath+"/CheckMsg?action=sendMsg&mediaType="+b+"&msgId="+g+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId+"&customerId="+f+"&msg="+escape(encodeURIComponent(XtimGlobalObject.encodeutf8(h)))+"&radomid="+Math.random()}else{var a="action=sendMsg&mediaType="+b+"&msgId="+g+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId+"&customerId="+f+"&msg="+escape(encodeURIComponent(XtimGlobalObject.encodeutf8(h)))+"&radomid="+Math.random();XtimGlobalObject.ajax(agentsiteimgaddresspath+"/CheckMsg","post",a,function(i){},function(){MobileChatWindow.addMsg("消息发送失败，请重试",XtLanguageConst.xtSystemMsg)})}if(d){if(b==1){var c=JSON.parse(h);MobileChatWindow.addToHistory('<img src="'+c.url+'" width="'+c.width+'" height="'+c.height+'">',"customer",XtLanguageConst.yours,g)}else{MobileChatWindow.addToHistory(h,"customer",XtLanguageConst.yours,g)}}if(MobileChatWindow.answerTimeOutHandler!=0){clearTimeout(MobileChatWindow.answerTimeOutHandler);MobileChatWindow.answerTimeOutHandler=0}if(XtimGlobalObject.curAgentAnswerTimeOut>0&&XtimGlobalObject.curAgentAnswerTimeOutMsg!=null&&XtimGlobalObject.curAgentAnswerTimeOutMsg!=""){MobileChatWindow.answerTimeOutHandler=window.setTimeout(function(){MobileChatWindow.addMsg(XtimGlobalObject.curAgentAnswerTimeOutMsg,"sysmsg",XtLanguageConst.xtSystemMsg)},XtimGlobalObject.curAgentAnswerTimeOut*1000)}return true};sendTalkProductInfo=function(d,c,b){var a=MobileChatWindow.getFlashMovieObject("agentwindowtzhiframe");if(a!=null&&isXtchatWindowReady==true){if(d!=null||c!=null){a.sendTalkProductInfo(d,c,b)}}};getMnDefaultUser=function(){var a=0;var c=null;for(a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.online=="1"&&b.onlyTransfer==0){c=b;break}}if(c==null){for(a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.onlyTransfer==0){c=b;break}}}if(c==null){c=AgentsListWindow.agentItems[0]}return c.agentNo};openXtInviteBoxTimerOut=function(){if(XtimGlobalObject.ie&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7)&&document.readyState!="complete"){XtimGlobalObject.addReadeyEvents(openXtInviteBoxTimerOut);return}if(xtInviteBoxOpenLimit==0){if(agentinviteStyle==0){window.setTimeout(AgentInviteWindow.openAgentInviteWindow,xtInviteBoxTimerOut)}else{if(agentinviteStyle==1){window.setTimeout(MobileChatWindow.openChatWindow,xtInviteBoxTimerOut)}else{MobileChatWindow.openMinChatWindow()}}return}var a=XtimGlobalObject.agentInviteGetCookie("xtOpenInviteBoxCount");if(a!=null){a=parseInt(a)}else{a=0}if(a>=xtInviteBoxOpenLimit){return}if(agentinviteStyle==0){setTimeout(AgentInviteWindow.openAgentInviteWindow,xtInviteBoxTimerOut)}else{if(agentinviteStyle==1){setTimeout(MobileChatWindow.openChatWindow,xtInviteBoxTimerOut)}else{MobileChatWindow.openMinChatWindow()}}XtimGlobalObject.agentInviteSetCookie("xtOpenInviteBoxCount",(a+1)+"")};setOpenXtInviteBoxFun=function(){XtimGlobalObject.xtOpenWindowFun=openXtInviteBoxTimerOut;if(xtOpenOnPageVisitSize>0||xtOpenOnVisitTimeCount>0){if(xtOpenOnPageVisitSize>0&&XtimGlobalObject.getXtPageVisitCount()>=xtOpenOnPageVisitSize&&!XtimGlobalObject.hasOpened){XtimGlobalObject.xtOpenWindowFun.call();XtimGlobalObject.hasOpened=true}}else{openXtInviteBoxTimerOut()}};openXtServiceList=function(){AgentsListWindow.openAgentListWindow()};getXtAgentByAgentNo=function(c){var a=0;for(a=0;a<AgentsListWindow.agentItems.length;a++){var b=AgentsListWindow.agentItems[a];if(b.agentNo==c){return b;break}}};function isMinStatus(){var a=false;if(window.outerWidth!=undefined){a=window.outerWidth<=160&&window.outerHeight<=27}else{a=window.screenTop<-30000&&window.screenLeft<-30000}return a}function xtAlertNewMsg(){AgentMsgTaskAlert.alertTask()}function xtNoAlertNewMsg(){AgentMsgTaskAlert.isStopTitleFlash=true;AgentMsgTaskAlert.stopTitleFlash();if(AgentMsgTaskAlert.pageTitle!=null){document.title=AgentMsgTaskAlert.pageTitle}}AgentMsgTaskAlert={time1:0,time2:0,time3:0,pageTitle:document.title,timerID:0,flashStatu:false,isStopTitleFlash:false,stopTitleFlash:function(){clearTimeout(AgentMsgTaskAlert.timerID);AgentMsgTaskAlert.isStopTitleFlash=true},flashTitle:function(){clearTimeout(AgentMsgTaskAlert.timerID);if(!AgentMsgTaskAlert.isStopTitleFlash){if(AgentMsgTaskAlert.flashStatu){document.title="\u60a8\u6709\u65b0\u7684\u6d88\u606f";AgentMsgTaskAlert.flashStatu=false}else{document.title=".........";AgentMsgTaskAlert.flashStatu=true}AgentMsgTaskAlert.timerID=setTimeout("AgentMsgTaskAlert.flashTitle()",600)}},alertTask:function(){AgentMsgTaskAlert.stop();AgentMsgTaskAlert.isStopTitleFlash=false;AgentMsgTaskAlert.flashTitle();AgentMsgTaskAlert.time1=setTimeout("AgentMsgTaskAlert.setMsgFlash1()","1000")},setMsgFlash1:function(){self.focus();AgentMsgTaskAlert.time2=setTimeout("AgentMsgTaskAlert.setMsgFlash2()","1000")},setMsgFlash2:function(){AgentMsgTaskAlert.time3=setTimeout("AgentMsgTaskAlert.setMsgFlash1()","1000")},stop:function(){clearTimeout(AgentMsgTaskAlert.time1);clearTimeout(AgentMsgTaskAlert.time2);clearTimeout(AgentMsgTaskAlert.time3)}};function openXtadLinkWindow(b){var a=mn$("xtadOpenLinkChatWindowForm");if(a==null){a=document.createElement("FORM");a.id="xtadOpenLinkChatWindowForm";a.method="GET";a.target="_blank";document.body.appendChild(a)}a.action=b;a.submit()}function playchatmsgsound(a){try{var b=mn$("chat_audio_player");if(b==null){b=document.createElement("audio");b.id="chat_audio_player";document.body.appendChild(b)}b.src=a;b.play()}catch(c){}}function playxtmsgsound(){if(agentisplaysound==1){try{var b=mn$("xt_chat_audio_player");if(b==null){b=document.createElement("audio");b.id="xt_chat_audio_player";b.src=agentsiteimgaddresspath+"/com/img/msgSound.mp3";document.body.appendChild(b);b.load()}b.play()}catch(a){}}}if(document.addEventListener){window.addEventListener("load",setXtPageLoadReady,true)}else{window.attachEvent("onload",setXtPageLoadReady)}if(document.attachEvent){document.attachEvent("onreadystatechange",XtimGlobalObject.onreadystatechangeHandler)}AgentsListWindow={ie:document.all,ns6:document.getElementById&&!document.all,dragapproved:false,z:null,dragx:0,dragy:0,temp1:0,temp2:0,agentItems:[],thirdSoftItems:[],groupItems:[],move:function(a){if(AgentsListWindow.dragapproved){if(xtAgentIconXpos=="left"){AgentsListWindow.z.style.left=(AgentsListWindow.ns6?AgentsListWindow.temp1+a.clientX-AgentsListWindow.dragx:AgentsListWindow.temp1+event.clientX-AgentsListWindow.dragx)+"px"}else{AgentsListWindow.z.style.right=(AgentsListWindow.ns6?AgentsListWindow.temp1-(a.clientX-AgentsListWindow.dragx):AgentsListWindow.temp1-(event.clientX-AgentsListWindow.dragx))+"px"}AgentsListWindow.z.style.top=(AgentsListWindow.ns6?AgentsListWindow.temp2+a.clientY-AgentsListWindow.dragy:AgentsListWindow.temp2+event.clientY-AgentsListWindow.dragy)+"px";return false}},drags:function(b){if(!AgentsListWindow.ie&&!AgentsListWindow.ns6){return}var c=AgentsListWindow.ns6?b.target:event.srcElement;var a=AgentsListWindow.ns6?"HTML":"BODY";while(c.nodeName!=a&&c.id!="agenttitlehandler"){if(c.parentNode==null){break}else{c=c.parentNode}}if(c.id=="agenttitlehandler"){AgentsListWindow.dragapproved=true;AgentsListWindow.z=mn$("agentListdiv");if(xtAgentIconXpos=="left"){AgentsListWindow.temp1=parseInt(AgentsListWindow.z.style.left)}else{AgentsListWindow.temp1=parseInt(AgentsListWindow.z.style.right)}AgentsListWindow.temp2=parseInt(AgentsListWindow.z.style.top);AgentsListWindow.dragx=AgentsListWindow.ns6?b.clientX:event.clientX;AgentsListWindow.dragy=AgentsListWindow.ns6?b.clientY:event.clientY;if(document.addEventListener){document.addEventListener("mousemove",AgentsListWindow.move,true)}else{document.attachEvent("onmousemove",AgentsListWindow.move)}XtimGlobalObject.showDiv(AgentsListWindow.z);return false}},enddrag:function(){AgentsListWindow.dragapproved=false;if(document.addEventListener){document.removeEventListener("mousemove",AgentsListWindow.move,true)}else{document.detachEvent("onmousemove",AgentsListWindow.move)}},getAgentRow:function(c){if(!AgentsListWindow.isShowAgent(c.agentNo)){return""}if(c.onlyTransfer==1){return""}var d="";var e="";var b="";if(c.online==0&&c.isSms==0){d=clientStyleWebPath+"/offLineIcon.png";e=clientStyleWebPath+"/offlinemicIcon.png";b=clientStyleWebPath+"/offlinevideoIcon.png"}else{e=clientStyleWebPath+"/micIcon.png";b=clientStyleWebPath+"/videoIcon.png";if(c.sex=="\u5973"){d=clientStyleWebPath+"/weman.png"}else{d=clientStyleWebPath+"/man.png"}}var a="<div class=agentRowStyle>";a+="<span class=agentlistheadstyle onClick=\"AgentsListWindow.clickopenchatwindow('"+c.agentId+"','"+c.agentName+'\');"><img title="立即在线交谈" src='+d+">"+c.agentName+"</span>";if(xtcustomerCanUseVideo=="1"){a+="<img class=agentlistmediaiconstyle onClick=\"AgentsListWindow.clickopenchatwindow('"+c.agentId+"','"+c.agentName+'\',1);" title="视频交流" src='+b+">"}if(xtcustomerCanUseMic=="1"){a+="<img class=agentlistmiciconstyle onClick=\"AgentsListWindow.clickopenchatwindow('"+c.agentId+"','"+c.agentName+'\',2);" title="语音交谈" src='+e+">"}a+="</div>";return a},getThirdSoftRow:function(d){var a="";var e="";if(d.type=="qq"){if(d.style=="45"){e="&nbsp;"+d.title}a='<a href="http://wpa.qq.com/msgrd?v=3&uin='+d.softNumber+'" title="'+d.title+'" target="_blank"><img border="0" src=http://wpa.qq.com/pa?p=2:'+d.softNumber+":"+d.style+">"+e+"</a>"}else{if(d.type=="msn"){a='<a href="msnim:chat?contact='+d.softNumber+'" title="'+d.title+'" target="_blank"><img src="'+agentsiteimgaddresspath+"/userAgentIcon/msn/msn"+d.style+'.png" border="0"/>&nbsp;'+d.title+"</a>"}else{if(d.type=="wang"){if(d.style=="2"){e="&nbsp;"+d.title}a='<a href="http://www.taobao.com/webww/ww.php?ver=3&siteid=cntaobao&status='+d.style+"&charset=utf-8&touid="+d.softNumber+'" title="'+d.title+'" target="_blank"><img src=http://amos.alicdn.com/online.aw?v=2&uid='+d.softNumber+"&site=cntaobao&s="+d.style+"&charset=utf-8>"+e+"</a>"}else{if(d.type=="wanggroup"){var c="";if(d.style=="1"){c="http://img04.taobaocdn.com/tps/i4/T1fdykXgtiXXXXXXXX-63-20.gif"}else{if(d.style=="2"){e="&nbsp;"+d.title;c="http://img02.taobaocdn.com/tps/i2/T1m206XhdDXXXXXXXX-25-20.gif"}else{if(d.style=="3"){c="http://img01.taobaocdn.com/tps/i1/T1o2J6XoFFXXXXXXXX-84-33.gif"}else{if(d.style=="4"){e="&nbsp;"+d.title;c="http://img03.taobaocdn.com/tps/i3/T1QLB6XgVDXXXXXXXX-42-33.gif"}}}}a='<a href="http://www.taobao.com/go/act/other/wwgroup.php?uid=&tribeid='+d.softNumber+'" title="'+d.title+'" style="font-size:12px;text-decoration:none;vertical-align:middle" target="_blank"><img style="display:inline" border="0" align=absmiddle src='+c+">"+e+"</a>"}else{if(d.type=="skype"){a='<a href="skype:'+d.softNumber+'?chat" title="'+d.title+'" style="font-size:12px;text-decoration:none;vertical-align:middle" target="_blank"><img style="display:inline" align=absmiddle src="'+agentsiteimgaddresspath+"/userAgentIcon/skype/skype"+d.style+'.gif" border="0"/></a>'}else{if(d.type=="email"){a='<a href="mailto:'+d.softNumber+'" title="'+d.title+'" style="font-size:12px;text-decoration:none;vertical-align:middle" target="_blank"><img style="display:inline" align=absmiddle src="'+agentsiteimgaddresspath+"/userAgentIcon/email/email"+d.style+'.png" border="0"/>&nbsp;'+d.title+"</a>"}else{if(d.type=="phone"){a='<a href="tel:'+d.softNumber+'" title="'+d.title+'" style="font-size:12px;text-decoration:none;vertical-align:middle" target="_blank"><img style="display:inline" align=absmiddle src="'+agentsiteimgaddresspath+"/userAgentIcon/phoneicon/phone"+d.style+'.png" border="0"/>&nbsp;'+d.softNumber+"</a>"}else{if(d.type=="arcode"){a='<div style="font-size:12px;text-decoration:none;vertical-align:middle;text-align:center;padding: 2px 2px 2px 2px;margin:0px;width:auto;height:auto">'+d.title+'</div><img style="display:inline;max-width:100%;width:auto;height:auto" align=absmiddle src="'+agentsiteimgaddresspath+"/getCommonFile/"+d.softNumber+'" border="0"/>'}}}}}}}}var b="<div class=thirdSoftRowStyle>";b=b+a+"</div>";return b},getGroupRow:function(a){var b="<div class=agentGroupStyle>"+a.groupName+"</div>";return b},isShowAgent:function(b){if(xtuids==null||xtuids.length==0){return true}for(var a=0;a<xtuids.length;a++){if(xtuids[a]==b){return true}}return false},openAgentListWindow:function(k){if(AgentsListWindow.ie&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7)&&document.readyState!="complete"){XtimGlobalObject.addReadeyEvents(AgentsListWindow.openAgentListWindow);return}var m=mn$("myfollowfloaterDiv1");if(m!=null){m.style.display="none"}m=mn$("myfollowfloaterDiv2");if(m!=null){m.style.display="none"}m=mn$("agentradomfloatertzh");if(m!=null){m.style.display="none"}var o=mn$("agentListdiv");if(o!=null){o.style.top=xtAgentIconYpos+"px";o.style.display="block";XtimGlobalObject.showDiv(o);o.focus();if(xtAgentIconXpos=="left"){o.style.left="1px"}else{o.style.right="1px"}return}o=document.createElement("div");o.id="agentListdiv";o.style.display="block";o.style.zIndex=2147483647;o.style.position="fixed";o.style.top=xtAgentIconYpos+"px";o.style.borderStyle="none";o.style.borderWidth="0px";document.body.appendChild(o);XtimGlobalObject.showDiv(o);var h="";var f;var d;var g="";for(f=0;f<AgentsListWindow.agentItems.length;f++){var c=AgentsListWindow.agentItems[f];if(c.groupId==null||c.groupId=="null"||c.groupId==""){if(c.online==1){h+=AgentsListWindow.getAgentRow(c)}else{g+=AgentsListWindow.getAgentRow(c)}}}h+=g;for(f=0;f<AgentsListWindow.groupItems.length;f++){var n=[];for(d=0;d<AgentsListWindow.agentItems.length;d++){var c=AgentsListWindow.agentItems[d];if(c.groupId==AgentsListWindow.groupItems[f].groupId&&c.onlyTransfer==0&&AgentsListWindow.isShowAgent(c.agentNo)){n[n.length]=c}}var a=[];for(d=0;d<AgentsListWindow.thirdSoftItems.length;d++){var l=AgentsListWindow.thirdSoftItems[d];if(l.groupId==AgentsListWindow.groupItems[f].groupId){a[a.length]=l}}if(n.length>0||a.length>0){h+=AgentsListWindow.getGroupRow(AgentsListWindow.groupItems[f])}g="";for(d=0;d<n.length;d++){var c=n[d];if(c.online==1){h+=AgentsListWindow.getAgentRow(c)}else{g+=AgentsListWindow.getAgentRow(c)}}h+=g;for(d=0;d<a.length;d++){h+=AgentsListWindow.getThirdSoftRow(a[d])}}for(f=0;f<AgentsListWindow.thirdSoftItems.length;f++){var l=AgentsListWindow.thirdSoftItems[f];if(l.groupId==null||l.groupId=="null"||l.groupId==""){h+=AgentsListWindow.getThirdSoftRow(AgentsListWindow.thirdSoftItems[f])}}var b=agentListTemplate.replace("#{innerContxt}",h);if(xtserviceListIcon==null){b=b.replace("#{xtserviceListIcon}","<img src='"+clientStyleWebPath+"/xtserviceListIcon.png'>")}else{b=b.replace("#{xtserviceListIcon}","<img src='"+agentsiteimgaddresspath+xtserviceListIcon+"'>")}o.innerHTML=b;mn$("mnsoftinfodiv").innerHTML='<img src="'+clientStyleWebPath+"/mnicon.png\"><a href='http://www.zxkefu.com' target='_blank'>"+XtLanguageConst.mnsoftinfo+"</a>";mn$("moningaddiv").innerHTML="<img src=http://www.molinsoft.com/arcode.png>";if(ismnuserhaspay==1){mn$("moningaddiv").style.display="none";mn$("mnsoftinfodiv").style.display="none"}else{mn$("moningaddiv").style.display="block";mn$("mnsoftinfodiv").style.display="block"}if(xtAgentIconXpos=="left"){o.style.left="1px"}else{o.style.right="1px"}XtimGlobalObject.showDiv(o);if(document.addEventListener){document.addEventListener("mousedown",AgentsListWindow.drags,true);document.addEventListener("mouseup",AgentsListWindow.enddrag,true)}else{document.attachEvent("onmousedown",AgentsListWindow.drags);document.attachEvent("onmouseup",AgentsListWindow.enddrag,true)}},closeAgentListFun:function(){var b=mn$("agentListdiv");if(b!=null){b.style.display="none"}var a=mn$("myfollowfloaterDiv1");if(a!=null){a.style.display="block"}a=mn$("myfollowfloaterDiv2");if(a!=null){a.style.display="block"}a=mn$("agentradomfloatertzh");if(a!=null){a.style.display="block"}},addAgent:function(d,n,f,g,j,e,k,l,m,a,c,i,b){var h={};h.agentId=d;h.agentNo=n;h.agentName=f;h.online=g;h.sex=j;h.groupId=e;h.qq=k;h.msn=l;h.isSms=m;h.agentSignature=a;h.answerTimeOutMsg=c;h.answerTimeOut=i;h.onlyTransfer=b;AgentsListWindow.agentItems[AgentsListWindow.agentItems.length]=h},addThirdSoft:function(g,f,c,e,d,a){var b={};b.id=g;b.groupId=c;b.title=f;b.type=e;b.style=d;b.softNumber=a;AgentsListWindow.thirdSoftItems[AgentsListWindow.thirdSoftItems.length]=b},addGroup:function(b,c){var a={};a.groupId=b;a.groupName=c;AgentsListWindow.groupItems[AgentsListWindow.groupItems.length]=a},clickopenchatwindow:function(a,d,c){MobileChatWindow.talkProductName=null;MobileChatWindow.talkProductImgPath=null;MobileChatWindow.talkProductPrice=null;if(typeof(c)!="undefined"){MobileChatWindow.openMediaType=c}else{MobileChatWindow.openMediaType=0}var b=XtimGlobalObject.getXtAgentByAgentId(a);if(XtimGlobalObject.customerId==null){return}xtNoAlertNewMsg();if(agentopenStyle==0){MobileChatWindow.closeChatWindow();XtimGlobalObject.openLinkChatWindow(b.agentNo)}else{MobileChatWindow.openChatWindowCenter(b.agentNo)}}};AgentsListWindow.addAgent("2c90eeb669c2745c0169c3531d8933b8","120822","基石金控",0,"女","null","null","null",0,"","我现在比较忙，请稍等",0,0);var inviteTemplate='<table id="invitagentwin" class="invitpngbg" style="table-layout:fixed;height:177px;width:332px;border-collapse:collapse;border:0px;margin:0px;padding:0px;border-spacing:0px; empty-cells:hide" width=400 heigth=180 border=0 cellspacing=0 cellpadding=0><tr>   <td id=agentInvitetitlehandler onselectstart="return false" class="xtstds" style="height:31px;line-height:31px;vertical-align:middle;text-align:center;position:relative;cursor:move;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;word-break:keep-all;font-size:12px;font-weight:bold">基石金控</td><td class="xtstds" style="position:relative;width:35px" align="left"><span style="position:static;border-style:none;border-width:0px;background-color:\'\'" onClick="document.getElementById(\'agentInviteListdiv\').style.display=\'none\';"><img src="https://4.molinsoft.com/agentIcon/default/closewin.gif" id="agentInviteCloseIcon" style="cursor:pointer;border-style:none;border-width:0px"></span></td></tr><tr>  <td colspan=2 class="xtstds" style="position:relative;height:146px">    <table style="height:146px;width:100%;border-collapse:collapse;border:0px;margin:0px;padding:0px;border-spacing:0px;empty-cells:hide">      <tr>          <td valign="middle" class="xtstds" style="height:100px" height="96px">			<table style="table-layout:fixed;width:100%;height:100px;border-collapse:collapse;border:0px;margin:0px;padding:0px;border-spacing:0px; empty-cells:hide" width="100%" height="96px"  border="0" cellspacing="0" cellpadding="0">				<tr>					<td width="120" class="xtstds" style="height:96px">&nbsp;</td>					<td width="100%" class="xtstds" style="font-size:12px;color:#000000;word-break:break-all; padding:15px">欢迎来自#area的朋友,有什么需要帮助的吗？</td>				</tr>			</table>		</td>      </tr>      <tr>        <td valign=top align=right class="xtstds" style="vertical-align:top;text-align:right;height:50px;padding-right:10px">			<table height="30" border="0" cellpadding="0" cellspacing="0 style="BORDER-BOTTOM:0px;BORDER-LEFT:0px;BORDER-TOP:0px;BORDER-RIGHT:0px;PADDING-TOP:0px;PADDING-BOTTOM:0px;PADDING-LEFT:0px;PADDING-RIGHT:0px;width:100%;height:30px;border-collapse:collapse;border:0px;margin:0px;padding:0px;border-spacing:0px;empty-cells:hide">		   <tr>		     <td class="xtstds" style="width:125px"></td>		     <td width="85" align="right" valign=middle class="xtstds" style="vertical-align:middle;text-align:right;height:27px" height=27>			    <table border="0" cellpadding="0" cellspacing="0" style="border-collapse:collapse;border:0px;margin:0px;padding:0px;border-spacing:0px; empty-cells:hide;width:85px;height:27px;vertical-align:middle;cursor:pointer" onClick="document.getElementById(\'agentInviteListdiv\').style.display=\'none\';">		    	 <tr>					<td align="center" valign="middle" class="xtstds" style="color:#FFFFFF;font-size: 12px;vertical-align:middle;height:27px;text-align:center;line-height:27px">下次再说</td>				 </tr>			    </table>			 </td>		     <td width="10" class="xtstds"></td>			 <td align=left valign=middle class="xtstds" style="vertical-align:middle;text-align:left;height:27px" height=27>			    <table border="0" cellpadding="0" cellspacing="0" style="width:100px;height:31px;vertical-align:middle;cursor:pointer;background-image:url(\'https://4.molinsoft.com/agentIcon/default/startChat.png\');border-collapse:collapse;border:0px;margin:0px;padding:0px;border-spacing:0px; empty-cells:hide" onClick="AgentInviteWindow.openchatwindow();">		    	 <tr>					<td valign="middle" class="xtstds" style="color:#FFFFFF;font-size:12px;vertical-align:middle;text-align:left;height:31px; line-height:31px; padding-left:15px;">开始交谈</td>				 </tr>			    </table>			 </td>		   </tr>		  </table>        </td>      </tr>    </table>  </td> </tr> </table>';var agentListTemplate='<div id="agenttitlehandler" onselectstart="return false">	<div id="mnagenttitlelabel">在线客服</div>    <img src="https://4.molinsoft.com/agentIcon/default/closeIcon.png" id="agentListCloseIcon" onClick="AgentsListWindow.closeAgentListFun();"></div><div id="mnagenlistbody">	<div id="mnserviceListIcondiv" onClick="openChatWindow();">#{xtserviceListIcon}</div>	<div id="mnagentlistcontext">#{innerContxt}</div>	<div id="moningaddiv"></div>	<div id="mnserviceListMsgdiv"></div>	<div id="mnsoftinfodiv"></div></div>';var agentWinTemplate='<div id="xtmsgtitlecontainer">    <img id="xtWinlogo">    <div id="xtmsgtitlecontainersub">    <div id="xtmsgtitlecontainersubtop">	    <div id="xtmsgtitlecontainerlabel"></div>	    <div id="miniinputStateDiv"></div>    </div>    <div id="mnagentSignature"></div>    </div>    <img id="xtmsgtitlecontainerclosebutton" onclick="XtimGlobalObject.closeChatWindow();">    <img id="xtNewBigWin" onclick="XtimGlobalObject.openXtChatWindow()"></div><div id="miniwinwaitingpanel"></div>    <div id="miniwinvideopanel">    <div id="mnvideolayout"></div></div><div id="xtmsgbodycontainer">    <div id="xtmsgbodycontainercontext"></div>    <div id="xtmsgrobotbodycontainercontext"></div></div><div id="minichattoolbar">    <div id="minifaceButton" onClick="MobileChatWindow.openFaceDiv()"></div>    <div id="miniinsertImgButton"><input id="miniuploadimg" name="miniuploadimg" type="file" onchange="MobileChatWindow.uploadimg()"></div>    <div id="miniinsertFileButton"><input id="miniuploadfile" name="miniuploadfile" type="file" onchange="MobileChatWindow.uploadfile()"></div>    <div id="miniappraiseButton" onClick="MobileChatWindow.openAppraiseDiv()"></div>    <div id="miniCustomerInfoButton" onClick="MobileChatWindow.openCustomerInfoPanel()"></div>    <div id="miniTelphoneButton" onClick="MobileChatWindow.openTelPanel()"></div>    <div id="xtminititletab" onclick="MobileChatWindow.changeMenuTab(1)"></div></div><div id="minimsgInputBoxdiv">	<textarea name="minixtChatWindowMsgInputBox" id="minixtChatWindowMsgInputBox" placeholder="请在这里输入" autocomplete="off" maxlength="200"></textarea></div><div id="xtmsgbuttoncontainer">	<div id="xtmsgbuttonopenbutton" onclick="MobileChatWindow.sendMsg()"></div></div><div id="mnsoftinfolabel"></div>';MobileChatWindow={ie:document.all,ns6:document.getElementById&&!document.all,dragapproved:false,z:null,dragx:0,dragy:0,temp1:0,temp2:0,talkProductName:null,talkProductImgPath:null,talkProductPrice:null,openMediaType:0,inputStateTimoutHandler:0,answerTimeOutHandler:0,autoSendMsgHandler:0,autoSendMsgIndex:0,isSendAgentOfflineMsg:false,hasShowHistoryMsged:false,xtmainAgentOfflineWords:null,appraisewinhtml:'<div class="mnclosePanelIcon" onclick="MobileChatWindow.closeAppraisePanel();"></div><div id="miniappraiseTitle"></div><div id="miniappraiseItems"></div><div id="miniappraiseremarklayout"><textarea maxlength="200" id="miniappraiseremarks"></textarea></div><div id="miniappraisesubmitlayout"><button id="miniappraisesubmitbutton" onclick="MobileChatWindow.minisendAppraise()"></button><div>',customerInfohtml:'<div class="mnclosePanelIcon" onclick="MobileChatWindow.closeCustomerInfoPanel();"></div><div id="minacustomerInfoTitle"></div><div id="minicustomercontent"></div><div id="minicustomersubmitlayout"><button id="minicustomerinfosubmitbutton" onclick="MobileChatWindow.sendCustomerInfo()"></button><div>',telpanelhtml:'<div id="mntelpaneltitle"></div><div id="mntelpaneldesc"></div><div id="mntelpanelinput"><input type="text" id="mntelpanelnumber" maxlength="16"/><span onclick="MobileChatWindow.submitTelPhone()"><div></div></span></div><div id="mntelpanelfooter"></div>',onTextfocus:function(){MobileChatWindow.sendInputStateNotice(1)},onTextBlur:function(){MobileChatWindow.sendInputStateNotice(0)},textcontrol:function(){var a=mn$("xtChatWindowMsgInputBox");if(a.value.length>200){a.value=a.value.substring(0,200)}if(curSelectTab==null||curSelectTab.id=="chattabtoolbartab1"){MobileChatWindow.sendCustomerPreMsg(a.value)}},closeAppraisePanel:function(){if(document.getElementById("miniappraiseWindowBox")!=null){XtimGlobalObject.removeObjectInIE(document.getElementById("miniappraiseWindowBox"))}},closeCustomerInfoPanel:function(){if(document.getElementById("miniCustomerInfoWindowBox")!=null){XtimGlobalObject.removeObjectInIE(document.getElementById("miniCustomerInfoWindowBox"))}},sendInputStateNotice:function(a){var e=XtimGlobalObject.customerId;if(e==null){e=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true)}var d="inputState="+a;var b=agentsiteimgaddresspath+"/CheckMsg?action=sendInputStateNotice&customerId="+e+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId;if(XtimGlobalObject.isJsonP()){var c=mn$("sendInputStateNoticeTag");if(c!=null){XtimGlobalObject.removeObjectInIE(c)}c=document.createElement("script");c.id="sendInputStateNoticeTag";document.body.appendChild(c);c.src=b+"&isJsonP=1&"+d+"&radomid="+Math.random()}else{XtimGlobalObject.ajax(b+"&radomid="+Math.random(),"post",d,function(f){},function(){})}},textareaonKeyPress:function(a){var a=a||window.event;if(a.keyCode==13){MobileChatWindow.sendMsg();if(a.preventDefault){a.preventDefault()}if(a.stopPropagation){a.stopPropagation()}if(window.event){window.event.returnValue=false;if(typeof window.event.cancleBubble!="undefined"){window.event.cancleBubble=true}}return false}},openMinChatWindow:function(){var a=mn$("xtMinChatWindowDiv");if(a!=null){a.style.display="block";return}a=document.createElement("div");a.id="xtMinChatWindowDiv";a.innerHTML='<div id="minxtmsgtitlecontainer"><img id="minxtWinlogo"><div id="minxtmsgtitlecontainerlabel" onclick="MobileChatWindow.openChatWindow()"></div><img id="minxtmsgtitlecontainerclosebutton" onclick="MobileChatWindow.closeMinChatWindow();"><img id="minxtNewBigWin" onclick="MobileChatWindow.openChatWindow()"></div>';document.body.appendChild(a);XtimGlobalObject.showDiv(a);mn$("minxtNewBigWin").src=clientStyleWebPath+"/expandIcon.png";if(customerPageLogo=="custmerLogo.png"){mn$("minxtWinlogo").src=clientStyleWebPath+"/"+customerPageLogo}else{mn$("minxtWinlogo").src=agentsiteimgaddresspath+"/"+customerPageLogo}mn$("minxtmsgtitlecontainerclosebutton").src=clientStyleWebPath+"/closewin.png";mn$("minxtmsgtitlecontainerlabel").innerHTML=XtimGlobalObject.curAgentName},closeMinChatWindow:function(){var a=mn$("xtMinChatWindowDiv");if(a!=null){a.style.display="none"}},move:function(a){if(MobileChatWindow.dragapproved){MobileChatWindow.z.style.right=(MobileChatWindow.ns6?MobileChatWindow.temp1-(a.clientX-MobileChatWindow.dragx):MobileChatWindow.temp1-(event.clientX-MobileChatWindow.dragx))+"px";MobileChatWindow.z.style.bottom=(MobileChatWindow.ns6?MobileChatWindow.temp2-(a.clientY-MobileChatWindow.dragy):MobileChatWindow.temp2-(event.clientY-MobileChatWindow.dragy))+"px";return false}},drags:function(b){if(!MobileChatWindow.ie&&!MobileChatWindow.ns6){return}var c=MobileChatWindow.ns6?b.target:event.srcElement;var a=MobileChatWindow.ns6?"HTML":"BODY";while(c.nodeName!=a&&c.id!="xtmsgtitlecontainer"){if(c.parentNode==null){break}else{c=c.parentNode}}if(c.id=="xtmsgtitlecontainer"){MobileChatWindow.dragapproved=true;MobileChatWindow.z=mn$("xtChatWindowDiv");MobileChatWindow.temp1=parseInt(MobileChatWindow.z.style.right);MobileChatWindow.temp2=parseInt(MobileChatWindow.z.style.bottom);MobileChatWindow.dragx=MobileChatWindow.ns6?b.clientX:event.clientX;MobileChatWindow.dragy=MobileChatWindow.ns6?b.clientY:event.clientY;if(document.addEventListener){document.addEventListener("mousemove",MobileChatWindow.move,true)}else{document.attachEvent("onmousemove",MobileChatWindow.move)}return false}},enddrag:function(){MobileChatWindow.dragapproved=false;if(document.addEventListener){document.removeEventListener("mousemove",MobileChatWindow.move,true)}else{document.detachEvent("onmousemove",MobileChatWindow.move)}},changeMenuTab:function(d){var b=mn$("xtChatWindowDiv");if(b==null||b.style.display=="none"){MobileChatWindow.openChatWindow()}var c=mn$("xtminititletab");var e=mn$("xtmsgbodycontainercontext");var a=mn$("xtmsgrobotbodycontainercontext");if(d==0){c.innerHTML=XtLanguageConst.servicerobot;c.setAttribute("onclick","MobileChatWindow.changeMenuTab(1)");e.style.display="block";a.style.display="none";mn$("xtmsgtitlecontainerlabel").innerHTML=XtimGlobalObject.curAgentName;if(XtimGlobalObject.waitcount==-1){mn$("miniwinwaitingpanel").style.display="none"}else{mn$("miniwinwaitingpanel").style.display="block"}}else{if(d==1){c.innerHTML=XtLanguageConst.personService;c.setAttribute("onclick","MobileChatWindow.changeMenuTab(0)");e.style.display="none";a.style.display="block";mn$("xtmsgtitlecontainerlabel").innerHTML=XtLanguageConst.robottitle;mn$("miniwinwaitingpanel").style.display="none";if(!RobotWindow.hasShowWecome){if(mnrobotWelcomeWords!=""){RobotWindow.addMsg(XtimGlobalObject.replace(mnrobotWelcomeWords,"xt",xtrobotName))}else{RobotWindow.addMsg(XtimGlobalObject.replace(XtLanguageConst.roboWelcomeMsg,"xt",xtrobotName))}RobotWindow.hasShowWecome=true}}}if(isUseRobot=="1"){mn$("xtminititletab").style.display="block"}},openChatWindowCenter:function(j){var c=0;var e=null;for(c=0;c<AgentsListWindow.agentItems.length;c++){var a=AgentsListWindow.agentItems[c];if(a.agentNo==j){e=a;break}}if(e==null){return}XtimGlobalObject.connectAgent(e.agentId,1);XtimGlobalObject.saveCustomerId(XtimGlobalObject.customerId,e.agentId,e.agentName,e.agentNo,e.sex,e.agentSignature,e.answerTimeOutMsg);MobileChatWindow.openChatWindow();var f=mn$("xtChatWindowDiv");var g=getDocWidth();var d=g.bodyWidth;var h=g.bodyHeight;var b=XtimGlobalObject.getInfo(f);if(b.right-b.left<450){f.style.width="450px"}if(b.bottom-b.top<550){f.style.width="550px"}b=XtimGlobalObject.getInfo(f);b.width=b.right-b.left;b.height=b.bottom-b.top;f.style.right=(d-b.width)/2+"px";f.style.bottom=(h-b.height)/2+"px"},openChatWindow:function(){MobileChatWindow.closeMinChatWindow();agentpreLoadMode=1;XtimGlobalObject.startCheckAgentMsgFun();var b=mn$("xtChatWindowDiv");if(b!=null){b.style.display="block";return}b=document.createElement("div");b.id="xtChatWindowDiv";b.style.width=agentminiwidth+"px";b.className="xtMobileChatWindowShodawStyle";b.innerHTML=agentWinTemplate;b.style.right="0px";b.style.bottom="0px";document.body.appendChild(b);if(isUseRobot=="1"){mn$("xtminititletab").style.display="block"}else{mn$("xtminititletab").style.display="none"}mn$("xtmsgbodycontainer").style.height=(agentminiheight-180)+"px";mn$("xtmsgrobotbodycontainercontext").style.display="none";MobileChatWindow.updateWaitingInfo();mn$("xtmsgtitlecontainersub").style.width=(agentminiwidth-150)+"px";mn$("xtmsgtitlecontainerlabel").innerHTML=XtimGlobalObject.curAgentName;if(XtimGlobalObject.curAgentSignature!=null){mn$("mnagentSignature").innerHTML=XtimGlobalObject.curAgentSignature}mn$("xtmsgbuttonopenbutton").innerHTML=XtLanguageConst.send;mn$("xtminititletab").innerHTML=XtLanguageConst.servicerobot;mn$("mnsoftinfolabel").innerHTML='<img src="'+clientStyleWebPath+"/mnicon.png\"><a href='http://www.zxkefu.com' target='_blank'>"+XtLanguageConst.mnsoftinfo+"</a>";if(ismnuserhaspay==1){mn$("mnsoftinfolabel").style.display="none"}try{mn$("minixtChatWindowMsgInputBox").placeholder=XtLanguageConst.pleaseinput}catch(c){}mn$("xtmsgtitlecontainerclosebutton").src=clientStyleWebPath+"/minicon.png";mn$("xtWinlogo").src=agentsiteimgaddresspath+"getHeadIcon?userId="+XtimGlobalObject.curAgentId;mn$("xtNewBigWin").src=clientStyleWebPath+"/changewin.png";mn$("minifaceButton").title=XtLanguageConst.insertFace;mn$("miniinsertImgButton").title=XtLanguageConst.insertImage;mn$("miniinsertFileButton").title=XtLanguageConst.tranfile;mn$("miniappraiseButton").title=XtLanguageConst.appraiseLabel;mn$("miniCustomerInfoButton").title=XtLanguageConst.custimerInfo;mn$("miniTelphoneButton").title=XtLanguageConst.gotelpone;if(agentisshowphone=="0"){mn$("miniTelphoneButton").parentNode.removeChild(mn$("miniTelphoneButton"))}if(mnisAppraise!="1"){mn$("miniappraiseButton").style.display="none"}var a=mn$("minixtChatWindowMsgInputBox");if(window.attachEvent){if(XtimGlobalObject.ie&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7||XtimGlobalObject.isIe8)){a.attachEvent("onpropertychange",MobileChatWindow.textcontrol)}else{a.attachEvent("oninput",MobileChatWindow.textcontrol)}a.attachEvent("onfocus",MobileChatWindow.onTextfocus);a.attachEvent("onblur",MobileChatWindow.onTextBlur);a.attachEvent("onkeypress",MobileChatWindow.textareaonKeyPress)}else{if(XtimGlobalObject.ie&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7||XtimGlobalObject.isIe8)){a.addEventListener("propertychange",MobileChatWindow.textcontrol,true)}else{a.addEventListener("input",MobileChatWindow.textcontrol,true)}a.addEventListener("focus",MobileChatWindow.onTextfocus,true);a.addEventListener("blur",MobileChatWindow.onTextBlur,true);a.addEventListener("keypress",MobileChatWindow.textareaonKeyPress,true)}if(document.addEventListener){document.addEventListener("mousedown",MobileChatWindow.drags,true);document.addEventListener("mouseup",MobileChatWindow.enddrag,true);MobileChatWindow.setImagePasteEvent()}else{document.attachEvent("onmousedown",MobileChatWindow.drags);document.attachEvent("onmouseup",MobileChatWindow.enddrag,true)}if(XtimGlobalObject.isSaveCustomerInfo!="1"&&isWriteCustomerInfo!="0"){MobileChatWindow.openCustomerInfoDiv()}MobileChatWindow.showHistoryMsg();MobileChatWindow.getAgentInfo()},updateWaitingInfo:function(){var a=mn$("miniwinwaitingpanel");if(XtimGlobalObject.waitcount>=0){a.style.display="block";a.innerHTML=XtLanguageConst.queueInfo.replace("#waitcount",XtimGlobalObject.waitcount)}else{a.style.display="none"}},textcontrol:function(){var a=mn$("minixtChatWindowMsgInputBox");if(a.value.length>200){a.value=a.value.substring(0,200)}MobileChatWindow.sendCustomerPreMsg(a.value)},sendCustomerPreMsg:function(e){var d=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true);if(d==null){d=XtimGlobalObject.customerId;if(d==null){return false}}var a=agentsiteimgaddresspath+"/CheckMsg?action=sendCustomerPreMsg&customerId="+d+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId;if(!XtimGlobalObject.isJsonP()){var c="msg="+encodeURIComponent(e);var b=mn$("sendCustomerPreMsgTag");if(b!=null){XtimGlobalObject.removeObjectInIE(b)}b=document.createElement("script");b.id="sendCustomerPreMsgTag";document.body.appendChild(b);b.src=a+"&isJsonP=1&"+c+"&radomid="+Math.random()}else{var c="msg="+e;XtimGlobalObject.ajax(a+"&radomid="+Math.random(),"post",c,function(f){},function(){})}if(MobileChatWindow.inputStateTimoutHandler!=0){window.clearTimeout(MobileChatWindow.inputStateTimoutHandler)}MobileChatWindow.inputStateTimoutHandler=window.setTimeout(function(){MobileChatWindow.sendInputStateNotice(0);MobileChatWindow.inputStateTimoutHandler=0},15*1000)},getAgentInfo:function(){var data="publishPointId="+customerPublishId+"&agentId="+XtimGlobalObject.curAgentId+"&curLanguage="+xtAgentCurLanguage;var url=agentsiteimgaddresspath+"/CheckMsg?action=getAgentInfo";if(XtimGlobalObject.isJsonP()){var scriptTag=mn$("agetAgentInfoScriptTag");if(scriptTag!=null){XtimGlobalObject.removeObjectInIE(scriptTag)}scriptTag=document.createElement("script");scriptTag.id="agetAgentInfoScriptTag";document.body.appendChild(scriptTag);scriptTag.src=url+"&isJsonP=1&"+data}else{XtimGlobalObject.ajax(url+"&radomid="+Math.random(),"post",data,function(responseText){var result=eval("("+responseText+")");if(result.xtmainAgentIsonline){if(XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_hasShowWelcome")==null||agentwelcommWordShowRate==1){MobileChatWindow.addMsg(result.xtmainAgentOnlineWords,"sysmsg");XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_hasShowWelcome","1")}}else{MobileChatWindow.isSendAgentOfflineMsg=true;MobileChatWindow.xtmainAgentOfflineWords=result.xtmainAgentOfflineWords;MobileChatWindow.addMsg(result.xtmainAgentOfflineWords,"sysmsg");if(mn$("xtmsgbuttonopenbutton")!=null){mn$("xtmsgbuttonopenbutton").innerHTML=XtLanguageConst.leavemessage}}loadServiceMenu();if(isUseRobot=="1"&&(!result.xtmainAgentIsonline||agentfirstrobot==1)){MobileChatWindow.changeMenuTab(1)}if(typeof(result.agentName)!="undefined"&&result.agentName!=null){XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentName",result.agentName);XtimGlobalObject.curAgentName=result.agentName;mn$("xtmsgtitlecontainerlabel").innerHTML=XtimGlobalObject.curAgentName}if(typeof(result.signature)!="undefined"&&result.signature!=null&&result.signature!="null"){XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentSignature",result.signature);XtimGlobalObject.curAgentSignature=result.signature;mn$("mnagentSignature").innerHTML=XtimGlobalObject.curAgentSignature}if(typeof(result.autoSendMsgList)!="undefined"){MobileChatWindow.showAutoSendMsgList(result.autoSendMsgList)}},function(){loadServiceMenu()})}},showAutoSendMsgList:function(a){if(XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_shwAutoMsg")!=null||MobileChatWindow.getHistoryMsg().length>0){return}XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_shwAutoMsg","1");if(a!=null&&a.length>0){MobileChatWindow.autoSendMsgHandler=setInterval(function(){if(MobileChatWindow.autoSendMsgIndex>=a.length){window.clearInterval(MobileChatWindow.autoSendMsgHandler);return}MobileChatWindow.addMsg(a[MobileChatWindow.autoSendMsgIndex].msg,XtimGlobalObject.curAgentId,XtimGlobalObject.curAgentName);MobileChatWindow.autoSendMsgIndex++},agentautoSendMsgaRate*1000)}},serverAgentInfoResult:function(a){if(a.xtmainAgentIsonline){if(XtimGlobalObject.agentInviteGetCookie(customerPublishId+"_hasShowWelcome")==null||agentwelcommWordShowRate==1){MobileChatWindow.addMsg(a.xtmainAgentOnlineWords,"sysmsg");XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_hasShowWelcome","1")}}else{MobileChatWindow.isSendAgentOfflineMsg=true;MobileChatWindow.xtmainAgentOfflineWords=a.xtmainAgentOfflineWords;MobileChatWindow.addMsg(a.xtmainAgentOfflineWords,"sysmsg");if(mn$("xtmsgbuttonopenbutton")!=null){mn$("xtmsgbuttonopenbutton").innerHTML=XtLanguageConst.leavemessage}}if(isUseRobot=="1"&&(!a.xtmainAgentIsonline||agentfirstrobot==1)){MobileChatWindow.changeMenuTab(1)}if(typeof(a.agentName)!="undefined"&&a.agentName!=null){XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentName",a.agentName);XtimGlobalObject.curAgentName=a.agentName;mn$("xtmsgtitlecontainerlabel").innerHTML=XtimGlobalObject.curAgentName}if(typeof(a.signature)!="undefined"&&a.signature!=null&&a.signature!="null"){XtimGlobalObject.agentInviteSetCookie(customerPublishId+"_agentSignature",a.signature);XtimGlobalObject.curAgentSignature=a.signature;mn$("mnagentSignature").innerHTML=XtimGlobalObject.curAgentSignature}if(typeof(a.autoSendMsgList)!="undefined"){MobileChatWindow.showAutoSendMsgList(a.autoSendMsgList)}if(typeof(a.autoSendMsgList)!="undefined"){MobileChatWindow.showAutoSendMsgList(a.autoSendMsgList)}loadServiceMenu()},closeChatWindow:function(){var a=mn$("xtChatWindowDiv");if(a!=null){a.style.display="none"}if(isShowXtOnlineServiceBox&&(agentinviteStyle==1||agentinviteStyle==2)){MobileChatWindow.openMinChatWindow()}},onCustomerInfoInputFocus:function(a){var a=a||window.event;var b=XtimGlobalObject.ns6?a.target:a.srcElement;if(b.id=="minicustomerName"){if(b.value==XtLanguageConst.customerName){b.value=""}}else{if(b.id=="mnmini_phoneNumber"){if(b.value==XtLanguageConst.phoneNumber){b.value=""}}else{if(b.id=="mnmini_phoneNumber"){if(b.value==XtLanguageConst.phoneNumber){b.value=""}}else{if(b.id=="mnmini_age"){if(b.value==XtLanguageConst.age){b.value=""}}else{if(b.id=="mnmini_mobileNumber"){if(b.value==XtLanguageConst.mobileNumber){b.value=""}}}}}}},onCustomerInfoInputBlur:function(a){var a=a||window.event;var b=XtimGlobalObject.ns6?a.target:a.srcElement;if(b.id=="minicustomerName"){if(b.value==""){b.value=XtLanguageConst.customerName}}else{if(b.id=="mnmini_phoneNumber"){if(b.value==""){b.value=XtLanguageConst.phoneNumber}}else{if(b.id=="mnmini_age"){if(b.value==""){b.value=XtLanguageConst.age}}else{if(b.id=="mnmini_mobileNumber"){if(b.value==""){b.value=XtLanguageConst.mobileNumber}}}}}},openCustomerInfoPanel:function(){MobileChatWindow.changeMenuTab(0);MobileChatWindow.openCustomerInfoDiv()},openCustomerInfoDiv:function(){if(mn$("miniCustomerInfoWindowBox")!=null){XtimGlobalObject.removeObjectInIE(mn$("miniCustomerInfoWindowBox"))}var d=document.createElement("div");d.id="miniCustomerInfoWindowBox";d.innerHTML=MobileChatWindow.customerInfohtml;var c=mn$("xtmsgbodycontainercontext");c.appendChild(d);mn$("minacustomerInfoTitle").innerHTML=XtLanguageConst.custimerInfo;mn$("minicustomerinfosubmitbutton").innerText=XtLanguageConst.submit;var b="";b+='<div class="minicustomerinforow"><input onblur="MobileChatWindow.onCustomerInfoInputBlur(event)" onfocus="MobileChatWindow.onCustomerInfoInputFocus(event)" value="'+XtLanguageConst.customerName+'" class="minicustomerinputTextStyle" type="text" id="minicustomerName" name="minicustomerName"  maxlength="64" /></div>';b+='<div class="minicustomerinforow"><label><input type="radio" name="mnmini_sex" id="mnmini_sex" value="0" > '+XtLanguageConst.sexmain+'</label><label><input type="radio" name="mnmini_sex" id="mnmini_sex" value="1"> '+XtLanguageConst.sexwemain+"</label></div>";b+='<div class="minicustomerinforow"><input onblur="MobileChatWindow.onCustomerInfoInputBlur(event)" onfocus="MobileChatWindow.onCustomerInfoInputFocus(event)"  maxlength="3" type="text" id="mnmini_age" name="mnmini_age" class="minicustomerinputTextStyle" value="'+XtLanguageConst.age+'" /></div>';b+='<div class="minicustomerinforow"><input onblur="MobileChatWindow.onCustomerInfoInputBlur(event)" onfocus="MobileChatWindow.onCustomerInfoInputFocus(event)" type="text" id="mnmini_phoneNumber" name="mnmini_phoneNumber"  maxlength="16" class="minicustomerinputTextStyle" value="'+XtLanguageConst.phoneNumber+'" /></div>';b+='<div class="minicustomerinforow"><input onblur="MobileChatWindow.onCustomerInfoInputBlur(event)" onfocus="MobileChatWindow.onCustomerInfoInputFocus(event)" type="text" id="mnmini_mobileNumber" name="mnmini_mobileNumber"  maxlength="16" class="minicustomerinputTextStyle" value="'+XtLanguageConst.mobileNumber+'" /></div>';mn$("minicustomercontent").innerHTML=b;var a=mn$("xtmsgbodycontainer");a.scrollTop=a.scrollHeight;MobileChatWindow.getCustomerInfo()},openTelPanel:function(){MobileChatWindow.changeMenuTab(0);if(mn$("miniTelpanelWindowBox")!=null){XtimGlobalObject.removeObjectInIE(mn$("miniTelpanelWindowBox"))}var c=document.createElement("div");c.id="miniTelpanelWindowBox";c.innerHTML=MobileChatWindow.telpanelhtml;var b=mn$("xtmsgbodycontainercontext");b.appendChild(c);mn$("mntelpaneltitle").innerHTML=XtLanguageConst.telpaneltitle;mn$("mntelpaneldesc").innerHTML="<ul><li>"+XtLanguageConst.telinputmobile+"</li><li>"+XtLanguageConst.telinputphone+"</li><ul>";mn$("mntelpanelfooter").innerHTML=XtLanguageConst.telpanelfooter;var a=mn$("xtmsgbodycontainer");a.scrollTop=a.scrollHeight},submitTelPhone:function(){var a=mn$("mntelpanelnumber").value.trim();if(a==""){alert(XtLanguageConst.pleaseInputPhone);return}var b=XtimGlobalObject.generateUUID();sendImMsg(XtLanguageConst.backphone+":"+a,b,false,0);MobileChatWindow.addMsg(XtLanguageConst.sendPhoneResult,"sysmsg",XtLanguageConst.msgalert,b)},playVideo:function(){var e=mn$("miniwinvideopanel");if(e.style.display=="block"){return}e.style.height=agentminiwidth/4*3+"px";mn$("mnvideolayout").innerHTML=XtLanguageConst.getflashplayer;var b="11.1.0";var d=agentsiteimgaddresspath+"/playerProductInstall.swf";var a={};var f={};f.quality="high";f.bgcolor="#ffffff";f.allowfullscreen="true";f.allowscriptaccess="always";var c={};c.align="middle";c.wmode="transparent";swfobject.embedSWF(agentsiteimgaddresspath+"mnvideo.swf","mnvideolayout","100%","100%",b,d,a,f,c);e.style.display="block"},closeVideoPanel:function(){XtimGlobalObject.removeObjectInIE(mn$("mnvideolayout"));var a=document.createElement("div");a.id="mnvideolayout";a.innerHTML=XtLanguageConst.getflashplayer;mn$("miniwinvideopanel").appendChild(a);mn$("miniwinvideopanel").style.display="none"},openAppraiseDiv:function(){MobileChatWindow.changeMenuTab(0);if(mn$("miniappraiseWindowBox")!=null){XtimGlobalObject.removeObjectInIE(mn$("miniappraiseWindowBox"))}var e=document.createElement("div");e.id="miniappraiseWindowBox";e.innerHTML=MobileChatWindow.appraisewinhtml;var c=mn$("xtmsgbodycontainercontext");c.appendChild(e);mn$("miniappraiseTitle").innerHTML=XtLanguageConst.appraiseTitle;mn$("miniappraisesubmitbutton").innerText=XtLanguageConst.submitAppraise;var b="";for(var d in mnappraiseMap){b+='<div class="miniappraiseitem"><label><input type="radio" id="miniappraiseSelect" name="miniappraiseSelect" value="'+d+'" />&nbsp;'+mnappraiseMap[d]+"</label></div>"}mn$("miniappraiseItems").innerHTML=b;var a=mn$("xtmsgbodycontainer");a.scrollTop=a.scrollHeight;mn$("miniappraiseremarks").placeholder=XtLanguageConst.pleaseinputremark},minisendAppraise:function(){var f=XtimGlobalObject.getRadioBoxValue("miniappraiseSelect");if(f==null){alert(XtLanguageConst.selectAppraise);return}var b=mnappraiseMap[f];var e=XtimGlobalObject.customerId;if(e==null){e=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true)}mn$("miniappraisesubmitbutton").disabled=true;var a=agentsiteimgaddresspath+"/CheckMsg?action=submitAppraise";if(XtimGlobalObject.isJsonP()){var d="agentId="+XtimGlobalObject.curAgentId+"&customerId="+e+"&publishPointId="+customerPublishId+"&appraiseStar="+b+"&appraiseValue="+f+"&appraiseNote="+encodeURIComponent(mn$("miniappraiseremarks").value);var c=mn$("sendAppraiseScriptTag");if(c!=null){XtimGlobalObject.removeObjectInIE(c)}c=document.createElement("script");c.id="sendAppraiseScriptTag";document.body.appendChild(c);c.src=a+"&isJsonP=1&"+d}else{var d="agentId="+XtimGlobalObject.curAgentId+"&customerId="+e+"&publishPointId="+customerPublishId+"&appraiseStar="+b+"&appraiseValue="+f+"&appraiseNote="+mn$("miniappraiseremarks").value;XtimGlobalObject.ajax(a+"&radomid="+Math.random(),"post",d,function(g){if(g!=null&&g=="1"){XtimGlobalObject.agentInviteSetCookie("hasAppraise_"+customerPublishId,"1");alert(XtLanguageConst.appraiseforthanks)}else{mn$("miniappraisesubmitbutton").disabled=false;alert(XtLanguageConst.appraisefaile)}},function(){mn$("miniappraisesubmitbutton").disabled=false;alert(XtLanguageConst.appraisefaile)})}},serverSendAppraiseResult:function(a){if(a!=null&&a=="1"){XtimGlobalObject.agentInviteSetCookie("hasAppraise_"+customerPublishId,"1");alert(XtLanguageConst.appraiseforthanks)}else{mn$("miniappraisesubmitbutton").disabled=false;alert(XtLanguageConst.appraisefaile)}},sendCustomerInfo:function(){var c=mn$("minicustomerName").value.trim();if(c==""||c==XtLanguageConst.customerName){alert(XtLanguageConst.namenotnull);return}var e=XtimGlobalObject.getRadioBoxValue("mnmini_sex");if(e==null){alert(XtLanguageConst.pleaseinputsex);return}var f=mn$("mnmini_age").value.trim();var i=/^\+?[0-9][0-9]*$/;if(!i.test(f)){alert(XtLanguageConst.agemustnum);return}var j=mn$("mnmini_phoneNumber").value.trim();var h=mn$("mnmini_mobileNumber").value.trim();if(j==XtLanguageConst.phoneNumber){j=""}if(h==XtLanguageConst.mobileNumber){h=""}var g=XtimGlobalObject.customerId;if(g==null){g=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true)}mn$("minicustomerinfosubmitbutton").disabled=true;var a=agentsiteimgaddresspath+"/CheckMsg?action=saveCustomer";if(XtimGlobalObject.isJsonP()){var d="customerId="+g+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId+"&customerName="+encodeURIComponent(c)+"&sex="+e+"&age="+f+"&phoneNumber="+encodeURIComponent(j)+"&mobileNumber="+encodeURIComponent(h);var b=mn$("sendCustomerInfoScriptTag");if(b!=null){XtimGlobalObject.removeObjectInIE(b)}b=document.createElement("script");b.id="sendCustomerInfoScriptTag";document.body.appendChild(b);b.src=a+"&isJsonP=1&"+d}else{var d="customerId="+g+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId+"&customerName="+c+"&sex="+e+"&age="+f+"&phoneNumber="+j+"&mobileNumber="+h;XtimGlobalObject.ajax(a+"&radomid="+Math.random(),"post",d,function(k){if(k!=null&&k=="1"){mn$("minicustomerinfosubmitbutton").disabled=false;XtimGlobalObject.isSaveCustomerInfo="1";XtimGlobalObject.agentInviteSetCookie("saveCustomer_"+customerPublishId,"1",true);alert(XtLanguageConst.savesuccuss)}else{mn$("minicustomerinfosubmitbutton").disabled=false;alert(XtLanguageConst.savefaile)}},function(){alert(XtLanguageConst.savefaile)})}},serverSendCustomerInfoResult:function(a){if(a!=null&&a=="1"){XtimGlobalObject.isSaveCustomerInfo="1";XtimGlobalObject.agentInviteSetCookie("saveCustomer_"+customerPublishId,"1",true);alert(XtLanguageConst.savesuccuss)}else{mn$("minicustomerinfosubmitbutton").disabled=false;alert(XtLanguageConst.savefaile)}},getCustomerInfo:function(){var customerId=XtimGlobalObject.customerId;if(customerId==null){customerId=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true)}var url=agentsiteimgaddresspath+"/CheckMsg?action=getCustomerInfo";if(XtimGlobalObject.isJsonP()){var data="customerId="+customerId+"&publishPointId="+customerPublishId;var scriptTag=mn$("sendGetCustomerInfoScriptTag");if(scriptTag!=null){XtimGlobalObject.removeObjectInIE(scriptTag)}scriptTag=document.createElement("script");scriptTag.id="sendGetCustomerInfoScriptTag";document.body.appendChild(scriptTag);scriptTag.src=url+"&isJsonP=1&"+data}else{var data="customerId="+customerId+"&publishPointId="+customerPublishId;XtimGlobalObject.ajax(url+"&radomid="+Math.random(),"post",data,function(responseText){if(responseText!=null){var results=eval("("+responseText+")");if(results.id){mn$("minicustomerName").value=results.customerName;if(results.sex=="0"){document.getElementsByName("mnmini_sex")[0].checked=true}else{document.getElementsByName("mnmini_sex")[1].checked=true}if(results.age!=0){mn$("mnmini_age").value=results.age}if(typeof(results.phone)=="undefined"&&results.phone!=""){mn$("mnmini_phoneNumber").value=results.phone}if(typeof(results.mobileNum)!="undefined"&&results.mobileNum!=""){mn$("mnmini_mobileNumber").value=results.mobileNum}}}})}},serverGetCustomerInfoResult:function(b){var a=b;if(a.id){mn$("minicustomerName").value=a.customerName;if(a.sex=="0"){mnmini_sex[0].checked=true}else{mnmini_sex[1].checked=true}if(a.age!=0){mn$("mnmini_age").value=a.age}if(typeof(a.phone)=="undefined"&&a.phone!=""){mn$("mnmini_phoneNumber").value=a.phone}if(typeof(a.mobileNum)!="undefined"&&a.mobileNum!=""){mn$("mnmini_mobileNumber").value=a.mobileNum}}},sendMsg:function(){if(mn$("xtmsgrobotbodycontainercontext").style.display!="none"){RobotWindow.sendMsg();return}if(XtimGlobalObject.isSaveCustomerInfo!="1"&&isWriteCustomerInfo=="2"&&MobileChatWindow.getHistoryMsg().length==0){MobileChatWindow.openCustomerInfoDiv();MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(XtLanguageConst.nosavecustomerinfo,"sysmsg");return}if(XtimGlobalObject.isChatEnd){XtimGlobalObject.addMsg(XtLanguageConst.chatendnosend,"sysmsg");return}if(XtimGlobalObject.waitcount>=0){XtimGlobalObject.addMsg(XtLanguageConst.waitingnosend,"sysmsg");return}var a=mn$("minixtChatWindowMsgInputBox");if(a.value.length==0){return}if(a.value.length>200){MobileChatWindow.addMsg(XtLanguageConst.msgtoolong,"sysmsg",XtLanguageConst.msgalert);return}var b=XtimGlobalObject.generateUUID();MobileChatWindow.addMsg(a.value,"customer",XtLanguageConst.yours,b);sendImMsg(a.value,b,true,0);a.value="";if(MobileChatWindow.isSendAgentOfflineMsg&&MobileChatWindow.xtmainAgentOfflineWords!=null&&MobileChatWindow.xtmainAgentOfflineWords!=""){MobileChatWindow.addMsg(MobileChatWindow.xtmainAgentOfflineWords,"sysmsg")}MobileChatWindow.isSendAgentOfflineMsg=false},addMsg:function(f,o,q,b){if(typeof(b)=="undefined"||b==null||b==""){b="msg"+Math.random()}else{if(document.getElementById(b)!=null){return}}var l=mn$("xtChatWindowDiv");if(l==null||l.style.display=="none"){MobileChatWindow.openChatWindow()}var k=mn$("xtmsgbodycontainercontext");var a="mn_msg msg-server";var r="mn_msg-cursor-server";var c="";if(typeof(o)=="undefined"&&(typeof(q)=="undefined"||q=="undefined")){q=XtimGlobalObject.curAgentName+"\uff1a";a="mn_msg mn_msg-server";c='<div class="minichatrecordheadIconleft">'+q+"</div>"}else{if(typeof(o)=="undefined"||o=="sysmsg"||q==XtLanguageConst.xtSystemMsg){q=XtLanguageConst.xtSystemMsg;a="mn_msg mn_msg-server";c='<div class="minichatrecordheadIconleft">'+q+"</div>"}else{if(o=="customer"){q=XtLanguageConst.yours;c='<div class="minichatrecordheadIconright">'+q+"</div>";a="mn_msg mn_msg-client";r="mn_msg-cursor-client"}else{a="mn_msg mn_msg-server";c='<div class="minichatrecordheadIconleft">'+q+"</div>"}}}k.innerHTML+='<div class="minichatrecordrow">'+c+'<div class="'+r+'"></div><div class="'+a+'"><div class="mn_msg-content" id="'+b+'">'+XtimGlobalObject.changeUrl(f)+"</div></div></div>";var p=mn$("xtmsgbodycontainer");p.scrollTop=p.scrollHeight;var e=mn$(b).getElementsByTagName("script");if(e!=null&&e.length>0){var j=e[0];var h=j.parentNode;h.removeChild(j);var n=document.createElement("script");n.type="text/javascript";n.innerHTML=j.innerHTML;h.appendChild(n)}var d=mn$(b).getElementsByTagName("img");if(d!=null&&d.length>0){for(var g=0;g<d.length;g++){var m=d[g];if(m.src.indexOf("mobileFace")==-1&&m.src.indexOf("chatfrom_voice_playing")==-1&&m.src.indexOf("apis.map.qq.com")==-1){m.style.cursor="pointer";m.setAttribute("onclick","MobileChatWindow.showImage(event)")}}}},saveZhuanjieMsg:function(c,j,d,a,e,b){var g=0;var h=null;for(g=0;g<AgentsListWindow.agentItems.length;g++){var f=AgentsListWindow.agentItems[g];if(f.agentId==c){h=f;break}}if(h==null){return}XtimGlobalObject.saveCustomerId(XtimGlobalObject.customerId,h.agentId,h.agentName,h.agentNo,h.sex,a,e,b)},addServiceMenuMsg:function(e,h,b){var f=null;if(typeof(b)=="undefined"||b==null){f=mn$("xtmsgbodycontainercontext")}else{f=b}var a="mn_msg msg-server";var i="mn_msg-cursor-server";var d="";if(typeof(h)=="undefined"||h=="undefined"){h=XtLanguageConst.xtSystemMsg+"\uff1a";a="mn_msg mn_msg-server";d='<div class="minichatrecordheadIconleft">'+h+"</div>"}else{if(h==XtLanguageConst.xtSystemMsg){a="mn_msg mn_msg-server";d='<div class="minichatrecordheadIconleft">'+h+"</div>"}else{d='<div class="minichatrecordheadIconright">'+XtLanguageConst.xtSystemMsg+"</div>";a="mn_msg mn_msg-client";i="mn_msg-cursor-client"}}var c="msg"+Math.random();f.innerHTML+='<div class="minichatrecordrow">'+d+'<div class="'+i+'"></div><div class="'+a+'"><div class="mn_msg-content" id="'+c+'"></div></div></div>';mn$(c).appendChild(e);var g=mn$("xtmsgbodycontainer");g.scrollTop=g.scrollHeight},showImage:function(f){var f=f||window.event;var g=XtimGlobalObject.ns6?f.target:f.srcElement;MobileChatWindow.closeShowImagePanel();var d=document.createElement("div");d.id="mnshowimagdiv";var i='<div id="mnshowimagdivtitle"><span onclick="MobileChatWindow.closeShowImagePanel()">╳</span></div><div id="mnshowimagdivbody"><img src="'+g.src+'"></div>';d.innerHTML=i;document.body.appendChild(d);var b=mn$("mnshowimagdivbody");var c=getDocWidth();var a=(c.bodyWidth-g.width)/2;var h=(c.bodyHeight-g.height)/2;if(g.width>800){a=(c.bodyWidth-800)/2;b.style.width="800px"}if(g.height>700){h=(c.bodyHeight-700)/2;b.style.height="700px"}d.style.left=a+"px";d.style.top=h+"px";XtimGlobalObject.showDiv(d)},closeShowImagePanel:function(){var a=mn$("mnshowimagdiv");if(a!=null){a.parentNode.removeChild(a)}},showHistoryMsg:function(){if(MobileChatWindow.hasShowHistoryMsged){return}if(agentisshowhistorymsg==1){var a=MobileChatWindow.getHistoryMsg();for(var b=0;b<a.length;b++){var c=a[b];MobileChatWindow.addMsg(c.msgContent.replace(/<script[^>]*?>[\s\S]*?<\/script>/gim,""),c.senderId,c.senderName,c.msgId)}}MobileChatWindow.hasShowHistoryMsged=true},hasHistoryMsg:function(e){var b=MobileChatWindow.getHistoryMsg();var a=false;for(var c=0;c<b.length;c++){var d=b[c];if(e==d.msgId){a=true;break}}return a},addToHistory:function(c,h,j,a){if(typeof(a)=="undefined"||a==null||a==""){a="msg"+Math.random()}if(typeof(j)=="undefined"){j="undefined"}var b=MobileChatWindow.getHistoryMsg();var f=false;for(var e=0;e<b.length;e++){var d=b[e];if(a==d.msgId){f=true;break}}if(!f){b.push({senderId:h,senderName:j,msgContent:c,msgId:a});if(b.length>5){b.splice(0,1)}var g=JSON.stringify(b);XtimGlobalObject.agentInviteSetCookie("history_"+customerPublishId,g,true)}},getHistoryMsg:function(){var hismsgArray=new Array();var hismsgstr=XtimGlobalObject.agentInviteGetCookie("history_"+customerPublishId,true);if(hismsgstr!=null&&hismsgstr!=""){try{hismsgArray=eval("("+hismsgstr+")")}catch(error){}}return hismsgArray},openFaceDiv:function(){if(XtimGlobalObject.isChatEnd){XtimGlobalObject.addMsg(XtLanguageConst.chatendnosend,"sysmsg");return}if(XtimGlobalObject.waitcount>=0){XtimGlobalObject.addMsg(XtLanguageConst.waitingnosend,"sysmsg");return}var e=mn$("minifacediv");if(e==null){e=document.createElement("div");e.id="minifacediv";var d="";for(var b=0;b<24;b++){d+='<img style="padding:3px;width:32px;height:32px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box" src="'+agentsiteimgaddresspath+"/mobileFace/f0"+b+'.png" onClick="MobileChatWindow.sendFace(\''+agentsiteimgaddresspath.replace("http://","https://")+"/mobileFace/f0"+b+'.png\')" style="padding:6px">'}d+='<img style="padding:3px;width:32px;height:32px;box-sizing:border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box" onClick="MobileChatWindow.closeFaceDiv()" src="'+agentsiteimgaddresspath+'mobileFace/button_cancel.png">';e.innerHTML=d;document.body.appendChild(e)}var a=XtimGlobalObject.getPoint(mn$("minichattoolbar"));e.style.left=(a.left-2)+"px";var c=parseInt(mn$("xtChatWindowDiv").style.bottom);e.style.bottom=(c+125)+"px";e.style.display="block"},closeFaceDiv:function(){var a=mn$("minifacediv");if(a!=null){a.style.display="none"}},sendFace:function(b){MobileChatWindow.closeFaceDiv();if(XtimGlobalObject.isSaveCustomerInfo!="1"&&isWriteCustomerInfo=="2"&&MobileChatWindow.getHistoryMsg().length==0){MobileChatWindow.openCustomerInfoDiv();MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(XtLanguageConst.nosavecustomerinfo,"sysmsg");return}var a=XtimGlobalObject.generateUUID();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg('<img style="width:32px;height:32px" src="'+b+'">',"customer",XtLanguageConst.yours,a);sendImMsg('<img width="32" height="32" src="'+b+'">',a,true,0)},onDocClickHideFaceDiv:function(b){var b=b||window.event;var c=XtimGlobalObject.ns6?b.target:b.srcElement;var a=XtimGlobalObject.ns6?"HTML":"BODY";while(c.nodeName!=a&&c.id!="minifacediv"){if(c.parentNode==null){break}else{c=c.parentNode}}if(c.id=="minifacediv"){return}MobileChatWindow.closeFaceDiv()},uploadimg:function(){if(XtimGlobalObject.isSaveCustomerInfo!="1"&&isWriteCustomerInfo=="2"&&MobileChatWindow.getHistoryMsg().length==0){MobileChatWindow.openCustomerInfoDiv();MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(XtLanguageConst.nosavecustomerinfo,"sysmsg");return}if(XtimGlobalObject.isChatEnd){XtimGlobalObject.addMsg(XtLanguageConst.chatendnosend,"sysmsg");return}if(XtimGlobalObject.waitcount>=0){XtimGlobalObject.addMsg(XtLanguageConst.waitingnosend,"sysmsg");return}if(typeof FormData=="undefined"){MobileChatWindow.addMsg("您的浏览器不支持文件上传","sysmsg",XtLanguageConst.xtSystemMsg);return}var file=mn$("miniuploadimg").files[0];var rFilter=/^(image\/bmp|image\/gif|image\/jpeg|image\/png|image\/tiff)$/i;if(!rFilter.test(file.type)){MobileChatWindow.clearImgUploadInput();MobileChatWindow.addMsg("文件格式必须为图片","sysmsg",XtLanguageConst.xtSystemMsg);return}if(!Image){MobileChatWindow.clearImgUploadInput();MobileChatWindow.addMsg("您的浏览器不支持文件上传","sysmsg",XtLanguageConst.xtSystemMsg);return}XtimGlobalObject.showLoading();var reader=new FileReader(),image=new Image(),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");reader.onload=function(){var url=reader.result;image.src=url};image.onload=function(){var w=image.naturalWidth,h=image.naturalHeight;var scale=1;if(w>600){scale=w/600}canvas.width=w/scale;canvas.height=h/scale;ctx.drawImage(image,0,0,w,h,0,0,canvas.width,canvas.height);fileUpload()};reader.readAsDataURL(file);function fileUpload(){var quality=0.8;var data=canvas.toDataURL("image/jpg",quality);data=data.split(",")[1];data=window.atob(data);var ia=new Uint8Array(data.length);for(var i=0;i<data.length;i++){ia[i]=data.charCodeAt(i)}var blob=new Blob([ia],{type:"image/jpeg"});if(mn$("mnuploadForm")==null){var uploadForm=document.createElement("form");uploadForm.id="mnuploadForm";uploadForm.enctype="multipart/form-data";document.body.appendChild(uploadForm)}var fd=new FormData(mn$("mnuploadForm"));fd.append("isMobile","1");fd.append("uploadimg",blob,"upload.png");var xhr=XtimGlobalObject.createXHR();xhr.addEventListener("load",function(event){MobileChatWindow.clearImgUploadInput();XtimGlobalObject.closeLoading();var results=eval("("+xhr.responseText+")");var msgId=XtimGlobalObject.generateUUID();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg('<img src="'+results.url.trim()+'">',"customer",null,msgId);var msgjsonob=new Object();msgjsonob.url=results.url.trim();msgjsonob.width=canvas.width;msgjsonob.height=canvas.height;sendImMsg(JSON.stringify(msgjsonob),msgId,true,1)},false);xhr.addEventListener("error",function(){MobileChatWindow.clearImgUploadInput();XtimGlobalObject.closeLoading();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg("图片上传失败","sysmsg",XtLanguageConst.xtSystemMsg)},false);xhr.addEventListener("abort",function(){MobileChatWindow.clearImgUploadInput();XtimGlobalObject.closeLoading();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg("图片上传失败","sysmsg",XtLanguageConst.xtSystemMsg)},false);xhr.open("POST",agentsiteimgaddresspath+"ChatImageUploadServlet");xhr.send(fd)}},clearImgUploadInput:function(){mn$("miniinsertImgButton").innerHTML='<input id="miniuploadimg" name="miniuploadimg" type="file" onchange="MobileChatWindow.uploadimg()">'},uploadfile:function(){if(XtimGlobalObject.isSaveCustomerInfo!="1"&&isWriteCustomerInfo=="2"&&MobileChatWindow.getHistoryMsg().length==0){MobileChatWindow.openCustomerInfoDiv();MobileChatWindow.changeMenuTab(0);XtimGlobalObject.addMsg(XtLanguageConst.nosavecustomerinfo,"sysmsg");return}if(XtimGlobalObject.isChatEnd){XtimGlobalObject.addMsg(XtLanguageConst.chatendnosend,"sysmsg");return}if(XtimGlobalObject.waitcount>=0){XtimGlobalObject.addMsg(XtLanguageConst.waitingnosend,"sysmsg");return}if(typeof FormData=="undefined"){MobileChatWindow.clearFileUploadInput();MobileChatWindow.addMsg("您的浏览器不支持文件上传","sysmsg",XtLanguageConst.xtSystemMsg);return}var file=mn$("miniuploadfile").files[0];if(file.size>10*1024*1024){MobileChatWindow.clearFileUploadInput();MobileChatWindow.addMsg("文件不能大于10M","sysmsg",XtLanguageConst.xtSystemMsg);return}XtimGlobalObject.showLoading();if(mn$("mnuploadForm")==null){var uploadForm=document.createElement("form");uploadForm.id="mnuploadForm";uploadForm.enctype="multipart/form-data";document.body.appendChild(uploadForm)}var fd=new FormData(mn$("mnuploadForm"));fd.append("isMobile","1");fd.append("uploadimg",file,file.name);var xhr=XtimGlobalObject.createXHR();xhr.addEventListener("load",function(event){MobileChatWindow.clearFileUploadInput();XtimGlobalObject.closeLoading();var results=eval("("+xhr.responseText+")");MobileChatWindow.changeMenuTab(0);MobileChatWindow.sendfile(results.fileSize,results.showName,results.url)},false);xhr.addEventListener("error",function(){MobileChatWindow.clearFileUploadInput();XtimGlobalObject.closeLoading();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg("文件上传失败","sysmsg",XtLanguageConst.xtSystemMsg)},false);xhr.addEventListener("abort",function(){MobileChatWindow.clearFileUploadInput();XtimGlobalObject.closeLoading();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg("文件上传失败","sysmsg",XtLanguageConst.xtSystemMsg)},false);xhr.open("POST",agentsiteimgaddresspath+"ChatImageUploadServlet");xhr.send(fd)},sendfile:function(a,d,c){var b=XtimGlobalObject.generateUUID();MobileChatWindow.addMsg(d+"<br>"+XtLanguageConst.fileTranfinished,"customer",XtLanguageConst.yours,b);MobileChatWindow.sendFileMsg(a,d,c,b,d+"<br>"+XtLanguageConst.fileTranfinished)},sendFileMsg:function(e,f,i,c,d){var h=XtimGlobalObject.customerId;if(h==null){h=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true);if(h==null){h=""}}var a=agentsiteimgaddresspath+"/CheckMsg?action=sendFileMsg&msgId="+c+"&agentId="+XtimGlobalObject.curAgentId+"&publishPointId="+customerPublishId+"&customerId="+h;if(XtimGlobalObject.isJsonP()){var g="fileSize="+e+"&fileName="+encodeURIComponent(f)+"&fileUrl="+encodeURIComponent(i)+"&synmsg="+encodeURIComponent(d);var b=mn$("sendFileMsgTag");if(b!=null){XtimGlobalObject.removeObjectInIE(b)}b=document.createElement("script");b.id="sendFileMsgTag";document.body.appendChild(b);b.src=a+"&isJsonP=1&"+g+"&radomid="+Math.random()}else{var g="fileSize="+e+"&fileName="+f+"&fileUrl="+i+"&synmsg="+d;XtimGlobalObject.ajax(a+"&radomid="+Math.random(),"post",g,function(j){},function(){alert("出错了")})}},clearFileUploadInput:function(){mn$("miniinsertFileButton").innerHTML='<input id="miniuploadfile" name="miniuploadfile" type="file" onchange="MobileChatWindow.uploadfile()">'},imgReader:function(item){var reader=new FileReader(),image=new Image(),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");reader.onload=function(){var url=reader.result;image.src=url};image.onload=function(){var w=image.naturalWidth,h=image.naturalHeight;var scale=1;if(w>600){scale=w/600}canvas.width=w/scale;canvas.height=h/scale;ctx.drawImage(image,0,0,w,h,0,0,canvas.width,canvas.height);fileUpload()};reader.readAsDataURL(item.getAsFile());function fileUpload(){var quality=0.8;var data=canvas.toDataURL("image/jpg",quality);data=data.split(",")[1];data=window.atob(data);var ia=new Uint8Array(data.length);for(var i=0;i<data.length;i++){ia[i]=data.charCodeAt(i)}var blob=new Blob([ia],{type:"image/jpeg"});if(mn$("mnuploadForm")==null){var uploadForm=document.createElement("form");uploadForm.id="mnuploadForm";uploadForm.enctype="multipart/form-data";document.body.appendChild(uploadForm)}var fd=new FormData(mn$("mnuploadForm"));fd.append("isMobile","1");fd.append("uploadimg",blob,"upload.png");var xhr=XtimGlobalObject.createXHR();xhr.addEventListener("load",function(event){XtimGlobalObject.closeLoading();var results=eval("("+xhr.responseText+")");var msgId=XtimGlobalObject.generateUUID();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg('<img src="'+results.url.trim()+'">',"customer",XtLanguageConst.yours,msgId);var msgjsonob=new Object();msgjsonob.url=results.url.trim();msgjsonob.width=canvas.width;msgjsonob.height=canvas.height;sendImMsg(JSON.stringify(msgjsonob),msgId,true,1)},false);xhr.addEventListener("error",function(){XtimGlobalObject.closeLoading();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg("图片上传失败","sysmsg",XtLanguageConst.xtSystemMsg)},false);xhr.addEventListener("abort",function(){XtimGlobalObject.closeLoading();MobileChatWindow.changeMenuTab(0);MobileChatWindow.addMsg("图片上传失败","sysmsg",XtLanguageConst.xtSystemMsg)},false);XtimGlobalObject.showLoading();xhr.open("POST",agentsiteimgaddresspath+"/ChatImageUploadServlet");xhr.send(fd)}},setImagePasteEvent:function(){var a=mn$("minixtChatWindowMsgInputBox");a.addEventListener("paste",function(g){var h=g.clipboardData,d=0,b,f,c;if(h){b=h.items;if(!b){return}f=b[0];c=h.types||[];for(;d<c.length;d++){if(c[d]==="Files"){f=b[d];break}}if(f&&f.kind==="file"&&f.type.match(/^image\//i)){MobileChatWindow.imgReader(f)}}})}};RobotWindow={hasShowWecome:false,sendMsg:function(){var b=mn$("minixtChatWindowMsgInputBox");if(b.value.length==0){return}if(b.value.length>200){RobotWindow.addMsg(XtLanguageConst.msgtoolong,XtLanguageConst.msgalert);return}var e=XtimGlobalObject.customerId;if(e==null){e=XtimGlobalObject.agentInviteGetCookie(customerPublishId,true)}var f=b.value;RobotWindow.addMsg(f,XtLanguageConst.yours);b.value="";var a=agentsiteimgaddresspath+"/CheckMsg?action=queryRobot&publishPointId="+customerPublishId+"&customerId="+e+"&agentId="+XtimGlobalObject.curAgentId;if(XtimGlobalObject.isJsonP()){var d="msg="+encodeURIComponent(f);var c=mn$("queryRobotTag");if(c!=null){XtimGlobalObject.removeObjectInIE(c)}c=document.createElement("script");c.id="queryRobotTag";document.body.appendChild(c);c.src=a+"&isJsonP=1&"+d+"&radomid="+Math.random()}else{var d="msg="+f;XtimGlobalObject.ajax(a+"&radomid="+Math.random(),"post",d,function(g){if(g=="no anwser"){RobotWindow.addMsg(XtLanguageConst.noanwser)}else{RobotWindow.addMsg(g)}},function(){alert(XtLanguageConst.neterr)})}},clearAllMsg:function(){var a=mn$("xtmsgrobotbodycontainercontext");a.innerHTML=""},queryResultMsg:function(a){if(a.result=="no anwser"){RobotWindow.addMsg(XtLanguageConst.noanwser)}else{RobotWindow.addMsg(a.result)}},addMsg:function(f,p){f=f.replace(/<font[^>]*?>/gim,"");f=f.replace(new RegExp("</font>","gim"),"");f=f.replace(/<p[^>]*?>/gim,"");f=f.replace(new RegExp("</p>","gim"),"");var l=mn$("xtChatWindowDiv");if(l==null||l.style.display=="none"){MobileChatWindow.openChatWindow()}var k=mn$("xtmsgrobotbodycontainercontext");var a="mn_msg msg-server";var q="mn_msg-cursor-server";var c="";if(typeof(p)=="undefined"||p=="undefined"){p=XtimGlobalObject.curAgentName+"\uff1a";a="mn_msg mn_msg-server";c='<div class="minichatrecordheadIconleft">'+xtrobotName+"</div>"}else{if(p==XtLanguageConst.xtSystemMsg){a="mn_msg mn_msg-server";c='<div class="minichatrecordheadIconleft">'+p+"</div>"}else{c='<div class="minichatrecordheadIconright">'+XtLanguageConst.yours+"</div>";a="mn_msg mn_msg-client";q="mn_msg-cursor-client"}}var b="msg"+Math.random();k.innerHTML+='<div class="minichatrecordrow">'+c+'<div class="'+q+'"></div><div class="'+a+'"><div class="mn_msg-content" id="'+b+'">'+XtimGlobalObject.changeUrl(f)+"</div></div></div>";var o=mn$("xtmsgbodycontainer");o.scrollTop=o.scrollHeight;var e=mn$(b).getElementsByTagName("script");if(e!=null&&e.length>0){var j=e[0];var h=j.parentNode;h.removeChild(j);var n=document.createElement("script");n.type="text/javascript";n.innerHTML=j.innerHTML;h.appendChild(n)}var d=mn$(b).getElementsByTagName("img");if(d!=null&&d.length>0){for(var g=0;g<d.length;g++){var m=d[g];if(m.src.indexOf("mobileFace")==-1&&m.src.indexOf("apis.map.qq.com")==-1){m.style.cursor="pointer";m.setAttribute("onclick","MobileChatWindow.showImage(event)")}}}}};var serviceMenuActionArray=new Array();var serviceMenuActionindex=0;function ServiceMenuAction(a,h,c,i,g,b,e,f,d){this.id=a;this.serviceMenu=h;this.serviceSubMenu=c;this.getParentServiceMenu=i;this.getNextServiceMenu=g;this.getRobot=b;this.changeAgentFun=e;this.changeGroup=f;this.autoGetAgent=d;this.clickAction=function(){if(c.action=="0"){g(c.id)}else{if(c.action=="1"){XtimGlobalObject.openLinkChatWindow(c.hrefAddress)}else{if(c.action=="2"){d()}else{if(c.action=="3"){e(c.connectAgentId,1)}else{if(c.action=="4"){f(c.connectGroupId)}else{if(c.action=="5"){b()}else{if(c.action=="6"){if(h.serviceSubMenuId==null){return}i(h.serviceSubMenuId)}}}}}}}}}function serviceMenuClickAction(d){var b=null;for(var c=0;c<serviceMenuActionArray.length;c++){var a=serviceMenuActionArray[c];if(a.id==d){b=a;break}}if(b!=null){if(b.serviceSubMenu.action=="0"){b.getNextServiceMenu(b.serviceSubMenu.id)}else{if(b.serviceSubMenu.action=="1"){location.href=b.serviceSubMenu.hrefAddress}else{if(b.serviceSubMenu.action=="2"){b.autoGetAgent()}else{if(b.serviceSubMenu.action=="3"){b.changeAgentFun(b.serviceSubMenu.connectAgentId,1)}else{if(b.serviceSubMenu.action=="4"){b.changeGroup(b.serviceSubMenu.connectGroupId)}else{if(b.serviceSubMenu.action=="5"){b.getRobot()}else{if(b.serviceSubMenu.action=="6"){if(b.serviceMenu.serviceSubMenuId==null){return}b.getParentServiceMenu(b.serviceMenu.serviceSubMenuId)}}}}}}}}}function loadServiceMenu(a){if(isServiceMenuEnable==1){var b=0;if(typeof a=="undefined"||a==null){b=1;a=customerPublishId}loadServiceMenuCommon(a,b)}}function loadServiceMenuCommon(serviceSubMenuId,idtype){var data="idtype="+idtype+"&serviceSubMenuId="+serviceSubMenuId;var url=agentsiteimgaddresspath+"/CheckMsg?action=getServiceMenu";XtimGlobalObject.ajax(url+"&radomid="+Math.random(),"post",data,function(responseText){var result=eval("("+responseText+")");var curServiceMenu=result.serviceMenu;var curServiceSubMenus=result.serviceSubMenuList;var curserviceMenuActionArray=new Array();if(curServiceSubMenus!=null&&curServiceSubMenus.length>0){for(var i=0;i<curServiceSubMenus.length;i++){var serviceSubMenu=curServiceSubMenus[i];serviceMenuActionindex++;var serviceMenuAction=new ServiceMenuAction(serviceMenuActionindex,curServiceMenu,serviceSubMenu,getParentServiceMenu,loadServiceMenu,menubackrobot,changeAgent,getAgentByGroup,autoGetAgent);serviceMenuActionArray.push(serviceMenuAction);curserviceMenuActionArray.push(serviceMenuAction)}}var xtChatWindowMsgBox=mn$("xtmsgbodycontainercontext");if(xtChatWindowMsgBox.style.display=="block"||mn$("xtmsgrobotbodycontainercontext").style.display=="none"){addServiceMenu(curServiceMenu,curServiceSubMenus,curserviceMenuActionArray,xtChatWindowMsgBox);if(idtype==1&&isUseRobot=="1"){addServiceMenu(curServiceMenu,curServiceSubMenus,curserviceMenuActionArray,mn$("xtmsgrobotbodycontainercontext"))}}else{if(isUseRobot=="1"){addServiceMenu(curServiceMenu,curServiceSubMenus,curserviceMenuActionArray,mn$("xtmsgrobotbodycontainercontext"))}if(idtype==1){addServiceMenu(curServiceMenu,curServiceSubMenus,curserviceMenuActionArray,xtChatWindowMsgBox)}}},function(){})}function menubackrobot(){MobileChatWindow.changeMenuTab(1)}function addServiceMenu(b,a,d,c){var g=document.createElement("div");g.style.margin="0px";g.style.padding="0px";g.style.width="auto";g.style.height="auto";if(typeof(b)!="undefined"&&typeof(b.menuText)!="undefined"&&b.menuText!=null&&b.menuText!=""){var j=document.createElement("span");j.innerHTML=XtimGlobalObject.replace(b.menuText,"\r","<br>");g.appendChild(j);var k=document.createElement("div");k.className="serviceMenuClickActionLine";g.appendChild(k)}if(a!=null&&a.length>0){for(var e=0;e<a.length;e++){var f=a[e];var h=document.createElement("a");h.innerHTML=f.menuTitle;h.className="serviceMenuClickActionStyle";if(f.action=="1"){h.setAttribute("href",f.hrefAddress);h.setAttribute("target","_blank")}else{h.setAttribute("onclick","serviceMenuClickAction('"+d[e].id+"')")}g.appendChild(h);g.appendChild(document.createElement("br"))}}MobileChatWindow.addServiceMenuMsg(g,XtLanguageConst.xtSystemMsg,c)}function getParentServiceMenu(a){loadServiceMenuCommon(a,2)}function autoGetAgent(){MobileChatWindow.addMsg(XtimGlobalObject.curAgentName+XtLanguageConst.serviceingforyou,"sysmsg")}function changeAgent(b,a){XtimGlobalObject.connectAgent(b,a)}function getAgentByGroup(a){}XtimGlobalObject.init();AgentInviteWindow={y:0,ie:document.all,ns6:mn$&&!document.all,dragapproved:false,z:null,dragx:0,dragy:0,temp1:0,temp2:0,move:function(a){if(AgentInviteWindow.dragapproved){AgentInviteWindow.z.style.left=(AgentInviteWindow.ns6?AgentInviteWindow.temp1+a.clientX-AgentInviteWindow.dragx:AgentInviteWindow.temp1+event.clientX-AgentInviteWindow.dragx)+"px";AgentInviteWindow.z.style.top=(AgentInviteWindow.ns6?AgentInviteWindow.temp2+a.clientY-AgentInviteWindow.dragy:AgentInviteWindow.temp2+event.clientY-AgentInviteWindow.dragy)+"px";return false}},drags:function(b){if(!AgentInviteWindow.ie&&!AgentInviteWindow.ns6){return}var c=AgentInviteWindow.ns6?b.target:event.srcElement;var a=AgentInviteWindow.ns6?"HTML":"BODY";while(c!=null&&c.nodeName!=a&&c.id!="agentInvitetitlehandler"){if(c.parentNode==null){break}else{c=c.parentNode}}if(c.id=="agentInvitetitlehandler"){AgentInviteWindow.dragapproved=true;AgentInviteWindow.z=mn$("agentInviteListdiv");AgentInviteWindow.temp1=parseInt(AgentInviteWindow.z.style.left+0);AgentInviteWindow.temp2=parseInt(AgentInviteWindow.z.style.top+0);AgentInviteWindow.dragx=AgentInviteWindow.ns6?b.clientX:event.clientX;AgentInviteWindow.dragy=AgentInviteWindow.ns6?b.clientY:event.clientY;if(document.addEventListener){document.addEventListener("mousemove",AgentInviteWindow.move,true)}else{document.attachEvent("onmousemove",AgentInviteWindow.move)}XtimGlobalObject.showDiv(AgentInviteWindow.z);return false}},enddrag:function(){AgentInviteWindow.dragapproved=false;var a=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;AgentInviteWindow.y=parseInt(mn$("agentInviteListdiv").style.top)-a;if(document.addEventListener){document.removeEventListener("mousemove",AgentInviteWindow.move,true)}else{document.detachEvent("onmousemove",AgentInviteWindow.move)}},openAgentInviteWindow:function(b){if(AgentInviteWindow.ie&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7)&&document.readyState!="complete"){XtimGlobalObject.addReadeyEvents(AgentInviteWindow.openAgentInviteWindow);return}if(mn$("agentInviteListdiv")!=null){mn$("agentInviteListdiv").style.display="block";XtimGlobalObject.showDiv(mn$("agentInviteListdiv"));mn$("agentInviteListdiv").focus();return}var i=document.createElement("div");i.id="agentInviteListdiv";i.style.display="block";i.style.zIndex=9000002;var j=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;var d=document.documentElement.scrollLeft?document.documentElement.scrollTop:document.body.scrollLeft;var k=getDocWidth();var a=k.bodyWidth;var m=k.bodyHeight;i.style.right=null;i.style.bottom=null;if(XtimGlobalObject.isIe6||!XtimGlobalObject.hasDocType()){i.style.position="absolute";i.style.top=(j+m/2-100)+"px";i.style.left=(d+a/2-400/2)+"px"}else{i.style.position="fixed";i.style.top=(m/2-100)+"px";i.style.left=(a/2-400/2)+"px"}i.style.borderStyle="none";i.style.borderWidth="0";i.style.overflow="hidden";i.style.textAlign="left";var g=document.createElement("div");g.id="xtInviteBoxBgDiv";g.style.display="block";g.style.position="absolute";g.style.borderStyle="none";g.style.borderWidth="0";g.style.overflow="hidden";g.style.left="0px";g.style.right="0px";g.style.width="100%";g.style.height="100%";i.appendChild(g);var f=document.createElement("div");f.style.display="block";f.style.position="relative";f.style.borderStyle="none";f.style.borderWidth="0";f.style.overflow="hidden";f.style.left="0px";f.style.right="0px";f.style.width="100%";f.style.height="100%";i.appendChild(f);document.body.appendChild(i);f.innerHTML=XtimGlobalObject.replace(inviteTemplate,"#area",mnuserarea);XtimGlobalObject.showDiv(i);if(agentbgaddressimg.indexOf("png")>0&&!AgentInviteWindow.ns6){var h=document.createStyleSheet();h.addRule(".invitpngbg","background:url("+agentsiteimgaddresspath+agentbgaddressimg+");background-repeat:no-repeat;_background:none; _filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+agentsiteimgaddresspath+agentbgaddressimg+" ,sizingMethod='crop')",0)}else{if(agentbgaddressimg.indexOf(".swf")>0){var l=mn$("invitagentwin").style.width;var c=mn$("invitagentwin").style.height;g.innerHTML="<div id='xtinviteflashbgdiv'></div>";swfobject.embedSWF(agentsiteimgaddresspath+agentbgaddressimg,"xtinviteflashbgdiv",l,c,"10.0.0",agentsiteimgaddresspath+"/expressInstall.swf",null,{wmode:"transparent"})}else{mn$("invitagentwin").style.backgroundImage="url("+agentsiteimgaddresspath+agentbgaddressimg+")";mn$("invitagentwin").style.backgroundRepeat="no-repeat"}}AgentInviteWindow.y=parseInt(i.style.top)-j;if(document.addEventListener){document.addEventListener("mousedown",AgentInviteWindow.drags,true);document.addEventListener("mouseup",AgentInviteWindow.enddrag,true)}else{document.attachEvent("onmousedown",AgentInviteWindow.drags);document.attachEvent("onmouseup",AgentInviteWindow.enddrag,true)}if(window.addEventListener){window.addEventListener("scroll",AgentInviteWindow.scroolwindowtopos,true)}else{window.attachEvent("onscroll",AgentInviteWindow.scroolwindowtopos)}},openchatwindow:function(){openXtChatWindow(XtimGlobalObject.curAgentUserName)},scroolwindowtopos:function(){if(!XtimGlobalObject.isIe6&&XtimGlobalObject.hasDocType()){return}var a=mn$("agentInviteListdiv");if(a){var b=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;if(b+AgentInviteWindow.y<0){AgentInviteWindow.y=b}else{a.style.top=(b+AgentInviteWindow.y)+"px"}}},start:function(){AgentInviteWindow.openAgentInviteWindow()}};MyFloaterAgent={};MyFloaterAgent.delta=0.15;MyFloaterAgent.collection=null;MyFloaterAgent.floaters=function(){this.items=[];this.addItem=function(a,d){var h=getDocWidth();var b=h.bodyWidth;var i=h.bodyHeight;var f=xtAgentIconXpos;var e=xtAgentIconYpos;var g=document.createElement("div");g.id=a;g.style.display="block";g.style.position="absolute";g.style.margin="0px";g.style.padding="0px";g.style.width="auto";g.style.height="auto";g.style.top=e+"px";g.style.borderStyle="none";g.style.zIndex=9000000;g.style.borderWidth=0;document.body.appendChild(g);XtimGlobalObject.showDiv(g);g.innerHTML=d;var c={};c.object=mn$(a);c.x=f;c.y=e;this.items[this.items.length]=c;if(f=="left"){g.style.left="1px"}else{g.style.left=b-g.clientWidth}};this.play=function(){MyFloaterAgent.collection=this.items;setInterval("playMyFloater()",10)}};playMyFloater=function(){for(var i=0;i<MyFloaterAgent.collection.length;i++){var followObj=MyFloaterAgent.collection[i].object;var posinfo=getDocWidth();var cbodyWidth=posinfo.bodyWidth;var cbodyHeight=posinfo.bodyHeight;var followObj_x;var xpost=MyFloaterAgent.collection[i].x;if(xpost=="left"){followObj_x=0}else{followObj_x=cbodyWidth-MyFloaterAgent.collection[i].object.clientWidth}var followObj_y=(typeof(MyFloaterAgent.collection[i].y)=="string"?eval(MyFloaterAgent.collection[i].y):MyFloaterAgent.collection[i].y);var cleft=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;if(followObj.offsetLeft!=(cleft+followObj_x)){var dx=(cleft+followObj_x-followObj.offsetLeft)*MyFloaterAgent.delta;dx=(dx>0?1:-1)*Math.ceil(Math.abs(dx));followObj.style.left=(followObj.offsetLeft+dx)+"px"}var ctop=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;if(followObj.offsetTop!=(ctop+followObj_y)){var dy=(ctop+followObj_y-followObj.offsetTop)*MyFloaterAgent.delta;dy=(dy>0?1:-1)*Math.ceil(Math.abs(dy));followObj.style.top=(followObj.offsetTop+dy)+"px"}}};showtzhMyFloater=function(){var b=document.all;if(b&&(XtimGlobalObject.isIe6||XtimGlobalObject.isIe7)&&document.readyState!="complete"){XtimGlobalObject.addReadeyEvents(showtzhMyFloater);return}var a=new MyFloaterAgent.floaters();a.addItem("myfollowfloaterDiv1","<div style='width:auto;height:auto;margin:0px;padding:0px;cursor:pointer;border-style:none;border-width:0px' onclick='showxtFloaterAgentListWin();'><img src='"+agentsiteimgaddresspath+agenticonaddressimg+"' border=0 style='max-width: max-content;'></div>");a.play()};showxtFloaterAgentListWin=function(){if(agenticonStyle==3){openXtChatWindow(XtimGlobalObject.curAgentUserName)}else{AgentsListWindow.openAgentListWindow()}};